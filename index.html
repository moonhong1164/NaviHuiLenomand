<!doctype html>
<html lang="ko">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>NAVI&HUI LENORMAND</title>
<style>
:root{
  --bg:#efe7fb;           /* ì—°ë³´ë¼ ë°°ê²½ */
  --panel:#ffffff;
  --ink:#3a2e57;
  --accent:#6c56b8;
  --shadow: 0 6px 24px rgba(28,22,53,.12);
  --cardw: 120px;         /* ê¸°ë³¸ ì¹´ë“œ í­(ê°€ë³€) */
  --radius:18px;
}

*{box-sizing:border-box}
html,body{margin:0;background:var(--bg);color:var(--ink);font-family:ui-sans-serif,system-ui,Apple SD Gothic Neo,Segoe UI,Arial,"Noto Sans KR",sans-serif}
h1{margin:16px 14px 8px;padding:14px 16px;border-radius:20px;background:
linear-gradient(90deg, rgba(255,255,255,.65), rgba(255,255,255,.2));
backdrop-filter:saturate(1.3) blur(4px); font-weight:900; letter-spacing:.5px;
color:#4a3ea0}

.topbar{margin:10px auto 0; max-width:980px; padding:10px 14px}
.controls{display:flex;flex-wrap:wrap; gap:10px; padding:14px; background:var(--panel); border-radius:22px; box-shadow:var(--shadow)}
.btn{appearance:none;border:0; border-radius:14px; padding:10px 16px; font-weight:700; box-shadow:var(--shadow); background:#f6f1ff; color:#5037c9; cursor:pointer}
.btn:active{transform:translateY(1px)}
.btn.puzzle{background:#edf8f1; color:#0f7f49}
.btn.plus{background:#f6fbff; color:#2d6fd3}

.stage{max-width:980px; margin:12px auto 40px; padding:0 14px}
.panel{background:var(--panel); border-radius:22px; box-shadow:var(--shadow); padding:16px; margin:14px 0}

.hint{font-weight:800; color:#6a59c8}

.spread{ --cw: var(--cardw); display:flex; gap:14px; justify-content:center; flex-wrap:nowrap}
.card-box{ width:var(--cw)}
.card{ position:relative; width:100%; aspect-ratio: 3/4; border-radius:18px; background:#cab6ee; box-shadow:0 6px 20px rgba(60,46,130,.22) inset, 0 6px 16px rgba(40,12,82,.18); overflow:hidden}
.card img{width:100%; height:100%; object-fit:cover; display:block; filter:drop-shadow(0 1px 0 rgba(255,255,255,.8))}
.cap{margin-top:8px; font-weight:900}
.note{font-size:12px; opacity:.78}

.pill{display:inline-flex; align-items:center; gap:6px; font-weight:800; font-size:12px; padding:4px 10px; border-radius:999px; margin-top:8px}
.pill.pos{color:#0b66ff; background:#e7f0ff}
.pill.neg{color:#d8262c; background:#ffe8ea}
.pill.neu{color:#09814a; background:#e8f7ef}

.summary{background:var(--panel); border-radius:18px; box-shadow:var(--shadow); padding:16px}
.summary .tone{display:inline-flex; align-items:center; gap:8px; font-weight:900}
.summary ul{margin:10px 0 0 0; padding-left:20px}
.summary li{margin:6px 0}

/* ì‹­ì ìŠ¤í”„ë ˆë“œ */
.cross-wrap{position:relative; width:100%; min-height:420px}
.cross-area{position:relative; margin:20px auto; width:min(560px, 92vw); height:min(420px, 70vw)}
.cross-area .card-box{position:absolute; width:clamp(84px, 24vw, 140px)}
.cross-center{left:50%; top:50%; transform:translate(-50%,-50%); z-index:3}
.cross-top{left:50%; top:8%; transform:translate(-50%,0)}
.cross-bottom{left:50%; bottom:6%; transform:translate(-50%,0)}
.cross-left{left:6%; top:50%; transform:translate(0,-50%)}
.cross-right{right:6%; top:50%; transform:translate(0,-50%)}

/* ê·¸ë‘íƒ€ë¸”ë¡œ */
.gt-wrap .hint{margin:10px 4px 8px}
.gt-grid{display:grid; gap:10px; grid-template-columns:repeat(var(--cols), var(--gtw));}
.gt-grid .card-box{width:var(--gtw)}
.gt-grid .card{aspect-ratio:3/4}
.ess-row{display:flex; gap:12px; overflow-x:auto}
.ess-row .card-box{width:clamp(68px, 18vw, 120px)}

/* ì¹´ë“œ ì „ì²´ ë³´ê¸°/ê²€ìƒ‰(ì˜µì…˜) ì˜ì—­ */
.tools{display:flex; gap:10px; flex-wrap:wrap; align-items:center; margin-top:10px}

@media (max-width:480px){
  .controls{gap:8px}
  .btn{padding:9px 12px}
  .spread{gap:10px}
  .summary{padding:14px}
}
</style>
</head>
<body>

<h1>NAVI&HUI LENORMAND</h1>

<div class="topbar">
  <div class="controls">
    <button class="btn" id="btn1">1ì¹´ë“œ</button>
    <button class="btn" id="btn3">3ì¹´ë“œ</button>
    <button class="btn" id="btn5">5ì¹´ë“œ</button>
    <button class="btn plus" id="btnCross">+ ì‹­ì</button>
    <button class="btn puzzle" id="btn9x4">9Ã—4</button>
    <button class="btn puzzle" id="btn8x4e">8Ã—4+4</button>
  </div>
</div>

<div class="stage" id="stage"></div>

<script>
/* =============== ë°ì´í„° =============== */
const NAMES = {
  1:"Rider (ê¸°ìˆ˜)",2:"Clover (í´ë¡œë²„)",3:"Ship (ì„ ë°•)",4:"House (ì§‘)",5:"Tree (ë‚˜ë¬´)",6:"Cloud (êµ¬ë¦„)",
  7:"Snake (ë±€)",8:"Coffin (ê´€)",9:"Bouquet (ë¶€ì¼€)",10:"Scythe (ë‚«)",11:"Whip (ì±„ì°)",12:"Bird (ìƒˆ)",
  13:"Child (ì•„ì´)",14:"Fox (ì—¬ìš°)",15:"Bear (ê³°)",16:"Stars (ë³„)",17:"Stork (í™©ìƒˆ)",18:"Dog (ê°œ)",
  19:"Tower (íƒ‘)",20:"Garden (ì •ì›)",21:"Mountain (ì‚°)",22:"Crossroad (ê°ˆë¦¼ê¸¸)",23:"Mice (ì¥)",24:"Heart (í•˜íŠ¸)",
  25:"Ring (ë°˜ì§€)",26:"Book (ì±…)",27:"Letter (í¸ì§€)",28:"Man (ë‚¨ì„±)",29:"Woman (ì—¬ì„±)",30:"Lily (ë°±í•©)",
  31:"Sun (íƒœì–‘)",32:"Moon (ë‹¬)",33:"Key (ì—´ì‡ )",34:"Fish (ë¬¼ê³ ê¸°)",35:"Anchor (ë‹»)",36:"Cross (ì‹­ìê°€)"
};

// í‚¤ì›Œë“œ(ìš”ì•½ìš©)
const KW = {
  1:"ì†Œì‹Â·ì†ë„",2:"ê¸°íšŒÂ·ìœ ì—°Â·ì‘ì€ í–‰ìš´",3:"ì—¬í–‰Â·í™•ì¥Â·ë³€í™”",4:"ê°€ì •Â·ì•ˆì •Â·ê¸°ë°˜",5:"ê±´ê°•Â·ì„±ì¥Â·ì‹œê°„",6:"í˜¼ë€Â·íŒë‹¨ ë³´ë¥˜",
  7:"ì¥ì• Â·ìœ í˜¹Â·ê¸°ë§Œ",8:"ëÂ·ì „í™˜Â·ì •ë¦¬Â·ì¬ì¶œë°œ",9:"ê¸°ì¨Â·ì„ ë¬¼Â·í˜¸ì˜",10:"ì ˆë‹¨Â·ê²°ë‹¨",11:"ê°ˆë“±Â·ë°˜ë³µÂ·ë£¨í”„ ëŠê¸°",12:"ëŒ€í™”Â·ì—°ë½Â·ì†Œí†µ",
  13:"ìƒˆ ì‹œì‘Â·ìˆœìˆ˜",14:"ì£¼ì˜Â·í˜„ì‹¤ì  íŒë‹¨",15:"ê¶Œìœ„Â·ìì›Â·ë³´í˜¸",16:"ë¹„ì „Â·í¬ë§Â·ì˜ê°",17:"ë³€í™”Â·ì´ë™",18:"ì‹ ë¢°Â·ìš°ì •Â·ë™ë§¹",
  19:"ì¡°ì§Â·ê±°ë¦¬Â·ê·œì •",20:"ëª¨ì„Â·ê³µê°œÂ·í‰íŒ",21:"ì§€ì—°Â·ì¥ì• Â·ë²½",22:"ì„ íƒÂ·ê²°ì •Â·ë°ì´í„° ë¹„êµ",23:"ì†Œëª¨Â·ë¶„ì‹¤Â·ë¶ˆì•ˆ",24:"ì‚¬ë‘Â·ì—´ì •Â·í˜¸ê°",
  25:"ê³„ì•½Â·ìˆœí™˜Â·ì¥ê¸°ì»¤ë°‹",26:"ë¹„ë°€Â·í•™ìŠµÂ·ë¬¸ì„œ",27:"ë¬¸ì„œÂ·ë©”ì¼Â·ìŠ¹ì¸",28:"í•µì‹¬ ì¸ë¬¼(ë‚¨ì„±)",29:"í•µì‹¬ ì¸ë¬¼(ì—¬ì„±)",30:"í‰í™”Â·ì„±ìˆ™Â·íœ´ì‹",
  31:"ì„±ê³µÂ·ê°€ì‹œì„±Â·ì—ë„ˆì§€",32:"ëª…ì˜ˆÂ·ê°ì •Â·ë¦¬ë“¬",33:"í•´ê²°Â·ì •ë‹µÂ·ëŒíŒŒêµ¬",34:"ì¬ë¬¼Â·êµë¥˜Â·ê±°ë˜",35:"ì•ˆì •Â·ê³ ì •Â·ì§€ì†ì„±",36:"ê³ ë‚œÂ·ì‹ ë…Â·ì±…ì„"
};

// í†¤ ë¶„ë¥˜(ê¸/ë¶€/ì¤‘)
const TONE = {
  pos:[1,2,3,4,5,9,12,13,15,16,17,18,20,24,25,27,30,31,32,33,34,35],
  neg:[6,7,8,10,11,21,23,36],
  neu:[14,19,22,26,28,29]
};
const toneOf = id => (TONE.pos.includes(id) ? "pos" : TONE.neg.includes(id) ? "neg" : "neu");
const toneIcon = t => t==="pos"?"ğŸ”µ":t==="neg"?"ğŸ”´":"ğŸŸ¢";
const toneText = t => t==="pos"?"ê¸ì •":t==="neg"?"ë¶€ì •":"ì¤‘ë¦½";

function imgSrc(id){
  const s = String(id).padStart(2,"0");
  return `images/ë ˆë…¸ë¨¼ë“œ-${s}.png`;
}

/* =============== ê³µí†µ ìœ í‹¸ =============== */
const stage = document.getElementById('stage');

function clearAll(){
  stage.innerHTML="";
}

function shuffle(a){ for(let i=a.length-1;i>0;i--){ const j=Math.floor(Math.random()*(i+1)); [a[i],a[j]]=[a[j],a[i]] } }
function pick(n){
  const ids=[...Array(36)].map((_,i)=>i+1);
  shuffle(ids);
  return ids.slice(0,n);
}

// ì¹´ë“œ ìº¡ì…˜ + í†¤ pill
function capHtml(id){
  const t=toneOf(id);
  return `
    <div class="cap">${id}. ${NAMES[id].split(" ")[0]} <span class="note">${NAMES[id].match(/\((.*?)\)/)?.[0]||""}</span></div>
    <div class="pill ${t}">${toneIcon(t)} ${toneText(t)}</div>
    <div class="note">${KW[id]}</div>
  `;
}

/* =============== ìš”ì•½(ì´í‰) =============== */
function renderSummary(ids, extraAdvice=""){
  const box=document.createElement('div');
  box.className="summary panel";

  // í†¤ ì¹´ìš´íŠ¸
  let p=0,n=0,u=0;
  ids.forEach(id=>{
    const t=toneOf(id); if(t==="pos")p++; else if(t==="neg")n++; else u++;
  });
  const toneBadge = (p>n)?"pos":(n>p)?"neg":"neu";

  box.innerHTML = `
    <div class="tone">${toneIcon(toneBadge)} <b>${toneText(toneBadge)}</b>
      <span class="note"> (ê¸ì • ${p} / ë¶€ì • ${n} / ì¤‘ë¦½ ${u})</span></div>
    <ul>${ids.map(id=>`<li><b>${id}. ${NAMES[id].split(" ")[0]}</b> â€” ${KW[id]}</li>`).join("")}</ul>
    <p style="margin-top:10px"><b>ê¶Œê³ :</b> ${toneBadge==="pos"?"ìš°í˜¸ì  íë¦„ì…ë‹ˆë‹¤. ë“¤ì–´ì˜¨ ì œì•ˆ/ì—°ë½ì„ í™œìš©í•´ ë³´ì„¸ìš”.":"ìƒí™©ì„ ê°ê´€í™”í•˜ê³  ì¶”ê°€ ë°ì´í„°ë¥¼ í™•ë³´í•˜ì„¸ìš”."}</p>
    ${extraAdvice ? `<p class="note"><b>ìš”ì•½:</b> ${extraAdvice}</p>` : "" }
  `;
  stage.appendChild(box);
}

/* =============== 1/3/5 ì¹´ë“œ =============== */
function renderLinear(n){
  clearAll();
  const ids=pick(n);

  const wrap=document.createElement('div');
  wrap.className="panel";
  wrap.innerHTML=`<div class="spread" id="spread-row">
    ${ids.map(id=>`
      <div class="card-box">
        <div class="card"><img src="${imgSrc(id)}" alt=""></div>
        ${capHtml(id)}
      </div>`).join("")}
  </div>`;
  stage.appendChild(wrap);

  // í™”ë©´ í­ì— ë§ì¶° ìë™ ì¶•ì†Œ
  requestAnimationFrame(()=>{
    const row = document.getElementById("spread-row");
    const gap = parseInt(getComputedStyle(row).gap||"14",10);
    const avail = wrap.clientWidth - 32;
    const defaultW = parseInt(getComputedStyle(document.documentElement).getPropertyValue('--cardw'))||120;
    const fitW = Math.floor((avail - gap*(n-1)) / n);
    const target = Math.max(72, Math.min(defaultW, fitW));
    row.style.setProperty('--cw', `${target}px`);
  });

  renderSummary(ids, (n===5) ? "ìš°í˜¸ì  íë¦„. ì„±ê³¼ ê°€ì‹œí™”/í•´ê²° ì‹¤ë§ˆë¦¬." : "");
}

/* =============== ì‹­ì ìŠ¤í”„ë ˆë“œ =============== */
function renderCross(){
  clearAll();
  const ids=pick(5); // ì¤‘ì•™, ì¢Œ, ìš°, ìƒ, í•˜
  const [center,left,right,top,bottom] = [ids[2], ids[0], ids[1], ids[3], ids[4]];

  const wrap=document.createElement('div');
  wrap.className="panel cross-wrap";
  wrap.innerHTML=`
    <div class="cross-area" id="cross">
      <div class="card-box cross-center"><div class="card"><img src="${imgSrc(center)}"></div>${capHtml(center)}</div>
      <div class="card-box cross-left"><div class="card"><img src="${imgSrc(left)}"></div>${capHtml(left)}</div>
      <div class="card-box cross-right"><div class="card"><img src="${imgSrc(right)}"></div>${capHtml(right)}</div>
      <div class="card-box cross-top"><div class="card"><img src="${imgSrc(top)}"></div>${capHtml(top)}</div>
      <div class="card-box cross-bottom"><div class="card"><img src="${imgSrc(bottom)}"></div>${capHtml(bottom)}</div>
    </div>`;
  stage.appendChild(wrap);

  // ìš”ì•½
  renderSummary([left,right,top,bottom,center], "ê´€ë§Â·ê· í˜•. ì„ íƒì§€ ë¹„êµì™€ ë°ì´í„° ë³´ê°•ì´ í•µì‹¬.");
}

/* =============== ê·¸ë‘íƒ€ë¸”ë¡œ =============== */
function renderGT(mode){ // '9x4' | '8x4e'
  clearAll();
  const ids=[...Array(36)].map((_,i)=>i+1); shuffle(ids);
  const is8x4e = (mode==="8x4e");
  const cols = is8x4e ? 8 : 9;
  const total = is8x4e ? 32 : 36;
  const main = ids.slice(0,total);
  const essence = is8x4e ? ids.slice(32) : [];

  const wrap=document.createElement("div");
  wrap.className="gt-wrap panel";
  const head=document.createElement("div");
  head.className="hint";
  head.textContent="ì¹´ë“œë¥¼ ëˆŒëŸ¬ í‚¤ ì¹´ë“œì˜ ì£¼ìœ„ ì¹´ë“œì™€ ë‚˜ì´íŒ…ì„ ì•„ë˜ì—ì„œ í™•ì¸í•˜ì„¸ìš”.";
  wrap.appendChild(head);

  const grid=document.createElement("div");
  grid.className="gt-grid";
  grid.style.setProperty("--cols", cols);
  grid.style.setProperty("--gtw","88px"); // ì´ˆê¸°ê°’
  main.forEach((id,idx)=>{
    const b=document.createElement("div");
    b.className="card-box"; b.innerHTML=`<div class="card"><img src="${imgSrc(id)}"></div>`;
    b.title = rowcol(idx,cols)+"  "+id+". "+NAMES[id];
    b.addEventListener("click",()=>onKey(main, idx, cols, id));
    grid.appendChild(b);
  });
  wrap.appendChild(grid);

  // ê°€ë¡œ ë§ì¶¤ í¬ê¸° ê³„ì‚°
  requestAnimationFrame(()=>{
    const gap = 10, pad=28;
    const avail = wrap.clientWidth - pad;
    const fit = Math.floor((avail - gap*(cols-1)) / cols);
    const target = Math.max(54, Math.min(96, fit));
    grid.style.setProperty("--gtw", target+"px");
  });

  // 8x4+4: ì—ì„¼ìŠ¤ 4ì¥ê³¼ ì´í‰(ìš”ì•½)
  if(is8x4e){
    const essWrap=document.createElement("div"); essWrap.className="panel";
    essWrap.innerHTML='<div class="hint" style="margin-bottom:8px">ì—ì„¼ìŠ¤ 4ì¥</div>';
    const essRow=document.createElement("div"); essRow.className="ess-row";
    essence.forEach(id=>{
      const el=document.createElement("div"); el.className="card-box";
      el.innerHTML=`<div class="card"><img src="${imgSrc(id)}"></div>${capHtml(id)}`;
      essRow.appendChild(el);
    });
    essWrap.appendChild(essRow);
    wrap.appendChild(essWrap);

    const sum=document.createElement("div"); sum.id="essSummary"; sum.className="summary";
    wrap.appendChild(sum);
    renderEssSummary(essence);
  }

  // ìƒì„¸(í‚¤ì¹´ë“œ í´ë¦­ ê²°ê³¼)
  const inspect=document.createElement("div");
  inspect.id="inspect"; inspect.className="panel"; inspect.innerHTML='<div class="hint">í‚¤ ì¹´ë“œë¥¼ ì„ íƒí•˜ë©´ ì•„ë˜ì— ìƒì„¸ê°€ í‘œì‹œë©ë‹ˆë‹¤.</div>';
  wrap.appendChild(inspect);

  stage.appendChild(wrap);
}

function rowcol(idx, cols){
  const r=Math.floor(idx/cols)+1, c=(idx%cols)+1;
  return `(${r}í–‰ ${c}ì—´)`;
}

function onKey(main, idx, cols, id){
  // ì£¼ë³€ 8ì¥ + ë‚˜ì´íŒ…(ê¸°ì‚¬ì´ë™) 4ì¥
  const around = neighbors(idx, cols, main.length).map(i=>main[i]).filter(Boolean);
  const knight = knighting(idx, cols, main.length).map(i=>main[i]).filter(Boolean);

  const box=document.getElementById("inspect");
  box.innerHTML = `
    <div class="hint" style="margin-bottom:8px">í‚¤ ì¹´ë“œ: <b>${id}. ${NAMES[id]}</b></div>
    <div class="spread" style="flex-wrap:wrap; gap:10px">
      ${[id,...around].map(x=>`<div class="card-box" style="width:86px"><div class="card"><img src="${imgSrc(x)}"></div></div>`).join("")}
    </div>
    <div class="hint" style="margin:12px 0 6px">ë‚˜ì´íŒ…</div>
    <div class="spread" style="flex-wrap:wrap; gap:10px">
      ${knight.map(x=>`<div class="card-box" style="width:86px"><div class="card"><img src="${imgSrc(x)}"></div></div>`).join("")}
    </div>
  `;
}

function neighbors(idx, cols, total){
  const rows=Math.ceil(total/cols);
  const r=Math.floor(idx/cols), c=idx%cols;
  const acc=[];
  for(let dr=-1; dr<=1; dr++){
    for(let dc=-1; dc<=1; dc++){
      if(dr===0 && dc===0) continue;
      const rr=r+dr, cc=c+dc;
      if(rr>=0 && rr<rows && cc>=0 && cc<cols){
        const i = rr*cols+cc;
        if(i<total) acc.push(i);
      }
    }
  }
  return acc;
}
function knighting(idx, cols, total){
  const rows=Math.ceil(total/cols);
  const r=Math.floor(idx/cols), c=idx%cols;
  const jumps=[[2,1],[1,2],[-1,2],[-2,1],[-2,-1],[-1,-2],[1,-2],[2,-1]];
  const out=[];
  jumps.forEach(([dr,dc])=>{
    const rr=r+dr, cc=c+dc;
    if(rr>=0 && rr<rows && cc>=0 && cc<cols){
      const i = rr*cols+cc;
      if(i<total) out.push(i);
    }
  });
  return out;
}

function renderEssSummary(list){
  const box=document.getElementById('essSummary'); if(!box) return;
  let p=0,n=0,u=0;
  list.forEach(id=>{ const t=toneOf(id); if(t==="pos")p++; else if(t==="neg")n++; else u++;});
  const dom =
  `<div class="tone">${toneIcon(p>n?"pos":n>p?"neg":"neu")}
   <b>${toneText(p>n?"pos":n>p?"neg":"neu")}</b>
   <span class="note"> (ê¸ì • ${p} / ë¶€ì • ${n} / ì¤‘ë¦½ ${u})</span></div>
   <ul>${list.map(id=>`<li><b>${id}. ${NAMES[id].split(" ")[0]}</b> â€” ${KW[id]}</li>`).join("")}</ul>`;
  box.innerHTML = dom;
}

/* =============== ë²„íŠ¼ =============== */
document.getElementById('btn1').onclick=()=>renderLinear(1);
document.getElementById('btn3').onclick=()=>renderLinear(3);
document.getElementById('btn5').onclick=()=>renderLinear(5);
document.getElementById('btnCross').onclick=()=>renderCross();
document.getElementById('btn9x4').onclick=()=>renderGT('9x4');
document.getElementById('btn8x4e').onclick=()=>renderGT('8x4e');

/* ì´ˆê¸°ì—” ì•„ë¬´ê²ƒë„ ë Œë”ë§í•˜ì§€ ì•ŠìŒ (ìš”ì²­ ì‚¬í•­) */
</script>
</body>
</html>