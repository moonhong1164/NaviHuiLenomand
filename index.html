<!doctype html>
<html lang="ko">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>NAVI&HUI LENORMAND</title>

<!-- ====== 스타일: 요청하신 '크기/배치' 수정만 포함 ====== -->
<style>
:root{
  --bg:#efe8fb;
  --panel:#f4ecff;
  --ink:#362c63;
  --shadow:0 6px 24px rgba(0,0,0,.07);
}
html,body{margin:0;padding:0;background:var(--bg);color:var(--ink);font-family:ui-sans-serif,system-ui,Segoe UI,Apple SD Gothic Neo,Roboto,Apple Color Emoji,Noto Color Emoji;}
.wrap{max-width:980px;margin:0 auto;padding:20px;}
.h1{font-size:38px;font-weight:900;letter-spacing:.5px;line-height:1.1;margin:16px 0 8px;}
.panel{background:var(--panel);border-radius:18px;box-shadow:var(--shadow);padding:16px 14px;margin:16px 0;}

.ctrl-row{display:flex;flex-wrap:wrap;gap:10px;align-items:center}
.badge{background:#fff;border-radius:12px;padding:10px 16px;font-weight:700;box-shadow:0 2px 8px rgba(0,0,0,.06);}
.input-q{flex:1;min-width:200px;display:flex;gap:8px;align-items:center}
.input-q input{flex:1;height:40px;border:0;border-radius:12px;padding:0 12px;background:#fff;box-shadow:inset 0 0 0 1px #e8defc;}
.btn{height:40px;border:0;border-radius:12px;padding:0 14px;background:#fff;font-weight:800;box-shadow:0 2px 8px rgba(0,0,0,.06);cursor:pointer}
.btn:active{transform:translateY(1px)}

.section{background:#fff;border-radius:22px;box-shadow:var(--shadow);padding:18px;margin:16px 0}

/* ====== 카드 공통(프로젝트 기존 카드 구성과 충돌 없도록 최소한만) ====== */
.card{display:flex;align-items:center;justify-content:center;background:#8f78bd22;border-radius:14px;box-shadow:0 2px 8px rgba(0,0,0,.07);overflow:hidden;}
.card > img{max-width:84%;height:auto;display:block}

/* ====== 십자스프레드: 겹침 방지 & 세로 안정 ====== */
.cross-area{
  position:relative;margin:12px auto;
  width:min(560px,92vw);
  height:min(72vh,92vw);
  --crossw:120px; /* JS에서 계산 갱신 */
}
.cross-card{width:var(--crossw);height:calc(var(--crossw)*1.4);}

/* ====== 그랑타블로: 가로 넘침 방지 & 자동 축소 ====== */
.gt-wrap{width:100%;overflow:hidden;}
.gt-grid{
  --gtw:72px; /* JS에서 48~84px 사이로 갱신 */
  display:grid;
  grid-template-columns:repeat(var(--gt-cols,8), var(--gtw));
  grid-auto-rows:calc(var(--gtw)*1.4);
  gap:10px; justify-content:center;
}

/* 총평 박스(기존 스타일 유지 느낌) */
.summary{background:#f7f3ff;border-radius:16px;padding:14px 16px;margin-top:14px;box-shadow:0 2px 8px rgba(0,0,0,.05);}
.summary h4{margin:4px 0 10px;font-size:18px}
.summary ul{margin:0 0 6px 18px;padding:0}
.summary li{margin:4px 0}
</style>
</head>
<body>
<div class="wrap">
  <div class="h1">NAVI&HUI LENORMAND</div>

  <!-- 컨트롤 패널 -->
  <div class="panel">
    <div class="ctrl-row">
      <div class="input-q">
        <span class="badge">질문 입력</span>
        <input id="q" placeholder="질문을 적어 주세요" />
      </div>
      <button class="btn" id="btn1">1카드</button>
      <button class="btn" id="btn3">3카드</button>
      <button class="btn" id="btn5">5카드</button>
      <button class="btn" id="btnCross">+ 십자</button>
      <button class="btn" id="btn9x4">9×4</button>
      <button class="btn" id="btn8x4">8×4+4</button>
    </div>
  </div>

  <!-- 표시 영역 -->
  <div class="section">
    <!-- 십자 -->
    <div id="cross" class="cross-area"></div>

    <!-- 그랑타블로 -->
    <div id="gtWrap" class="gt-wrap" style="margin-top:16px">
      <div id="gtGrid" class="gt-grid"></div>
      <div id="gtSummary" class="summary" style="display:none"></div>
    </div>
  </div>
</div>

<!-- ====== 스크립트: 요청하신 배치/크기 문제만 해결 ====== -->
<script>
/* -------------------------
   도우미: 가상 카드(이미지 없이 번호만) 생성
   - 실제 프로젝트에서는 기존 렌더 함수를 그대로 쓰셔도 됩니다.
--------------------------*/
function makeCardEl(n){
  const d=document.createElement('div');
  d.className='card';
  d.textContent = n; // (여기서는 번호만, 기존 프로젝트는 카드 컴포넌트가 채움)
  return d;
}

/* ================== 십자 스프레드 ================== */
function renderCross(cards=[7,1,10,21,35]){ // [중앙, 좌, 우, 상, 하] 등 기존 순서에 맞춰 전달
  const area = document.getElementById('cross');
  area.innerHTML = `
    <div id="crossC" class="card cross-card" style="position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);"></div>
    <div id="crossL" class="card cross-card" style="position:absolute;"></div>
    <div id="crossR" class="card cross-card" style="position:absolute;"></div>
    <div id="crossT" class="card cross-card" style="position:absolute;"></div>
    <div id="crossB" class="card cross-card" style="position:absolute;"></div>
  `;

  // 내용 채우기(여기서는 번호만; 실제에선 카드 DOM 채우는 기존 함수 사용)
  [ 'crossC','crossL','crossR','crossT','crossB' ].forEach((id,idx)=>{
    const el=document.getElementById(id); el.textContent=cards[idx] ?? '';
  });

  requestAnimationFrame(()=>{
    const w = area.clientWidth;
    const h = area.clientHeight;
    const gap=16, side=16, topbot=16;

    const cwByWidth  = Math.floor((w - side*2 - gap*2) / 3);
    const availH = h - topbot*2;
    const cwByHeight = Math.floor((availH - 2*gap) / 4.2); // 3행 * 1.4 + 2 gap

    const cw = Math.max(72, Math.min(120, Math.min(cwByWidth, cwByHeight)));
    area.style.setProperty('--crossw', cw + 'px');

    const ch = Math.floor(cw*1.4);
    const cx = Math.floor(w/2), cy = Math.floor(h/2);
    const setPos = (el,x,y)=>{ el.style.left=x+'px'; el.style.top=y+'px'; el.style.transform='translate(-50%,-50%)'; };

    const C = document.getElementById('crossC');
    const L = document.getElementById('crossL');
    const R = document.getElementById('crossR');
    const T = document.getElementById('crossT');
    const B = document.getElementById('crossB');

    setPos(C, cx, cy);
    setPos(L, cx - (cw + gap), cy);
    setPos(R, cx + (cw + gap), cy);
    setPos(T, cx, cy - (ch + gap));
    setPos(B, cx, cy + (ch + gap));
  });
}

/* ================== 그랑타블로 ================== */
function renderGT(mode='9x4'){
  const wrap = document.getElementById('gtWrap');
  const grid = document.getElementById('gtGrid');
  const summary = document.getElementById('gtSummary');
  const cols = (mode==='9x4') ? 9 : 8;
  grid.style.setProperty('--gt-cols', cols);

  // 그리드 채우기(여기선 36장 번호만; 실제 프로젝트는 기존 카드 DOM 사용)
  const total = (mode==='9x4') ? 36 : 36; // 카드 수는 동일, 배치는 다름
  grid.innerHTML='';
  for(let i=1;i<=total;i++){
    grid.appendChild(makeCardEl(i));
  }

  // 에센스/총평 영역은 기존 로직을 그대로 사용하세요.
  summary.style.display='none'; // (요청: 배치만 수정)

  // 사이즈 맞추기
  requestAnimationFrame(()=>{
    fitGT(wrap, grid, cols);
    if(!grid._resizeBound){
      window.addEventListener('resize', ()=>fitGT(wrap, grid, cols));
      grid._resizeBound = true;
    }
  });
}

/* 가로 넘침 방지 자동 축소(48~84px 사이) */
function fitGT(wrap, grid, cols){
  const gap = 10;
  const pad = 28; // 좌우 내부여백(보수적)
  const avail = wrap.clientWidth - pad;
  const fit = Math.floor((avail - gap*(cols-1)) / cols) - 1;
  const target = Math.max(48, Math.min(84, fit));
  grid.style.setProperty('--gtw', target + 'px');
}

/* ===== 데모용 버튼: 실제 프로젝트는 기존 핸들러 그대로 두세요 ===== */
document.getElementById('btnCross').addEventListener('click', ()=>renderCross());
document.getElementById('btn9x4').addEventListener('click', ()=>renderGT('9x4'));
document.getElementById('btn8x4').addEventListener('click', ()=>renderGT('8x4'));

/* 초기엔 아무 것도 자동으로 펼치지 않음(요청 유지) */
renderCross([]);            // 빈 상태 렌더(영역만 잡아주기)
document.getElementById('gtGrid').innerHTML=''; // 그랑타블로도 기본 비움
</script>
</body>
</html>