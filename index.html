<!doctype html>
<html lang="ko">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>NAVI&HUI LENORMAND</title>

<style>
:root{ --bg:#efe8fb; --panel:#f4ecff; --ink:#362c63; --shadow:0 6px 24px rgba(0,0,0,.07);}
html,body{margin:0;padding:0;background:var(--bg);color:var(--ink);font-family:ui-sans-serif,system-ui,Segoe UI,Apple SD Gothic Neo,Roboto;}
.wrap{max-width:980px;margin:0 auto;padding:20px;}
.h1{font-size:38px;font-weight:900;letter-spacing:.5px;line-height:1.1;margin:16px 0 8px;}
.panel{background:var(--panel);border-radius:18px;box-shadow:var(--shadow);padding:16px 14px;margin:16px 0;}
.ctrl-row{display:flex;flex-wrap:wrap;gap:10px;align-items:center}
.badge{background:#fff;border-radius:12px;padding:10px 16px;font-weight:700;box-shadow:0 2px 8px rgba(0,0,0,.06);}
.input-q{flex:1;min-width:200px;display:flex;gap:8px;align-items:center}
.input-q input{flex:1;height:40px;border:0;border-radius:12px;padding:0 12px;background:#fff;box-shadow:inset 0 0 0 1px #e8defc;}
.btn{height:40px;border:0;border-radius:12px;padding:0 14px;background:#fff;font-weight:800;box-shadow:0 2px 8px rgba(0,0,0,.06);cursor:pointer}
.btn:active{transform:translateY(1px)}
.section{background:#fff;border-radius:22px;box-shadow:var(--shadow);padding:18px;margin:16px 0}

/* 카드 외곽 컨테이너 공통(기존 카드 컴포넌트와 충돌 없음) */
.card-shell{display:flex;align-items:center;justify-content:center;}

/* ── 십자: 겹침 방지 & 세로 안정 ── */
.cross-area{position:relative;margin:12px auto; width:min(560px,92vw); height:min(72vh,92vw);}
.cross-card{width:var(--crossw,110px);height:calc(var(--crossw,110px)*1.4);}

/* ── 그랑타블로: 가로 넘침 방지 & 자동 축소 ── */
.gt-wrap{width:100%;overflow:hidden;}
.gt-grid{
  --gtw:72px; /* JS에서 48~84px 사이로 자동 조절 */
  display:grid; grid-template-columns:repeat(var(--gt-cols,8), var(--gtw));
  grid-auto-rows:calc(var(--gtw)*1.4); gap:10px; justify-content:center;
}
.summary{background:#f7f3ff;border-radius:16px;padding:14px 16px;margin-top:14px;box-shadow:0 2px 8px rgba(0,0,0,.05);}
.summary h4{margin:4px 0 10px;font-size:18px}
.summary ul{margin:0 0 6px 18px;padding:0}
.summary li{margin:4px 0}
</style>
</head>
<body>
<div class="wrap">
  <div class="h1">NAVI&HUI LENORMAND</div>

  <div class="panel">
    <div class="ctrl-row">
      <div class="input-q">
        <span class="badge">질문 입력</span>
        <input id="q" placeholder="질문을 적어 주세요" />
      </div>
      <button class="btn" id="btn1">1카드</button>
      <button class="btn" id="btn3">3카드</button>
      <button class="btn" id="btn5">5카드</button>
      <button class="btn" id="btnCross">+ 십자</button>
      <button class="btn" id="btn9x4">9×4</button>
      <button class="btn" id="btn8x4">8×4+4</button>
    </div>
  </div>

  <div class="section">
    <!-- 십자 -->
    <div id="cross" class="cross-area"></div>

    <!-- 그랑타블로 -->
    <div id="gtWrap" class="gt-wrap" style="margin-top:16px">
      <div id="gtGrid" class="gt-grid"></div>
      <div id="gtSummary" class="summary" style="display:none"></div>
    </div>
  </div>
</div>

<script>
/* ========= 카드 DOM 가져오기 =========
   기존 프로젝트의 카드 생성 함수를 그대로 사용합니다.
   - window.renderCard(n) 이 정의돼 있으면 그걸로 DOM을 받아서 붙입니다.
   - 정의돼 있지 않다면 '임시 사각형(placeholder)'만 만들어요.  */
function getCardDOM(n){
  if (typeof window.renderCard === 'function') {
    return window.renderCard(n);    // ⬅️ 여기: 당신 프로젝트 전역 함수
  }
  // (fallback) 임시 카드 – 개발용
  const d=document.createElement('div');
  d.className='card-shell';
  d.style.cssText='width:100%;height:100%;background:#8f78bd22;border-radius:14px;box-shadow:0 2px 8px rgba(0,0,0,.07);font-weight:800;';
  d.textContent = n;
  return d;
}

/* ========= 십자 스프레드 (겹침 방지 & 세로 안정) ========= */
function renderCross(cards=[7,1,10,21,35]){ // [중앙, 좌, 우, 상, 하]
  const area = document.getElementById('cross');
  area.innerHTML = '';
  const ids=['C','L','R','T','B'];
  ids.forEach((k,i)=>{
    const wrap=document.createElement('div');
    wrap.className='card-shell cross-card';
    wrap.id='cross'+k;
    wrap.style.position='absolute';
    wrap.appendChild(getCardDOM(cards[i] ?? ''));
    area.appendChild(wrap);
  });

  requestAnimationFrame(()=>{
    const w = area.clientWidth, h = area.clientHeight;
    const gap=16, side=16, topbot=16;
    const cwW = Math.floor((w - side*2 - gap*2) / 3);
    const cwH = Math.floor((h - topbot*2 - 2*gap) / 4.2); // 3행*1.4 + 여백
    const cw = Math.max(72, Math.min(120, Math.min(cwW, cwH)));
    area.style.setProperty('--crossw', cw + 'px');
    const ch = Math.floor(cw*1.4);
    const cx = Math.floor(w/2), cy = Math.floor(h/2);

    const setPos = (id,x,y)=>{ const el=document.getElementById(id); el.style.left=x+'px'; el.style.top=y+'px'; el.style.transform='translate(-50%,-50%)'; };
    setPos('crossC', cx, cy);
    setPos('crossL', cx - (cw + gap), cy);
    setPos('crossR', cx + (cw + gap), cy);
    setPos('crossT', cx, cy - (ch + gap));
    setPos('crossB', cx, cy + (ch + gap));
  });
}

/* ========= 그랑타블로 (가로 넘침 자동 축소) ========= */
function renderGT(mode='9x4'){
  const wrap = document.getElementById('gtWrap');
  const grid = document.getElementById('gtGrid');
  const cols = (mode==='9x4') ? 9 : 8;
  grid.style.setProperty('--gt-cols', cols);

  // 기존 카드 DOM으로 채우기
  const total = 36;
  grid.innerHTML='';
  for(let i=1;i<=total;i++){
    const cell=document.createElement('div');
    cell.style.width='var(--gtw)'; cell.style.height='calc(var(--gtw)*1.4)';
    cell.appendChild(getCardDOM(i));
    grid.appendChild(cell);
  }

  requestAnimationFrame(()=>{
    fitGT(wrap, grid, cols);
    if(!grid._resizeBound){
      window.addEventListener('resize', ()=>fitGT(wrap, grid, cols));
      grid._resizeBound = true;
    }
  });
}

/* 48~84px 사이에서 자동으로 맞춰 그리드가 화면 밖으로 나가지 않게 함 */
function fitGT(wrap, grid, cols){
  const gap = 10, pad = 28;
  const avail = wrap.clientWidth - pad;
  const fit = Math.floor((avail - gap*(cols-1)) / cols) - 1;
  const target = Math.max(48, Math.min(84, fit));
  grid.style.setProperty('--gtw', target + 'px');
}

/* 데모 버튼 – 실제 프로젝트 핸들러 유지 OK */
document.getElementById('btnCross').addEventListener('click', ()=>renderCross());
document.getElementById('btn9x4').addEventListener('click', ()=>renderGT('9x4'));
document.getElementById('btn8x4').addEventListener('click', ()=>renderGT('8x4'));

/* 요청사항 유지: 처음엔 자동으로 아무 스프레드도 펼치지 않음 */
document.getElementById('gtGrid').innerHTML='';
</script>
</body>
</html>