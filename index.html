<!doctype html>

<html lang="ko">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>NAVI&HUI LENORMAND</title>
  <style>
    :root{
      --bg:#efe7fa;           /* ë¼ì¼ë½ í†¤ ë°°ê²½ */
      --panel:#f6f1ff;        /* ì¹´ë“œ ì£¼ë³€ íŒ¨ë„ */
      --ink:#2b2352;          /* í—¤ë” í…ìŠ¤íŠ¸ */
      --muted:#6f67a3;
      --ring:#d8cef6;
      --chip:#e9e1ff;
      --shadow:0 12px 30px rgba(28,22,52,.15);/* í¬ê¸° í† í° */
  --card-w:clamp(110px, 20vw, 180px);
  --card-h:calc(var(--card-w)*1.55);
  --spread-card:clamp(95px, 18vw, 160px);
  --gt-card:clamp(56px, 9.2vw, 88px);  /* ê·¸ë‘íƒ€ë¸”ë¡œ ê³ ì • í¬ê¸°(ëª¨ë°”ì¼ì—ì„œë„ í•œ í™”ë©´) */
  --gap:12px;
}
*{box-sizing:border-box}
html,body{height:100%}
body{margin:0;background:var(--bg);font-family:system-ui,Apple SD Gothic Neo,Noto Sans KR,Segoe UI,Roboto,sans-serif;color:var(--ink)}

header{position:sticky;top:0;z-index:20;background:radial-gradient(120% 100% at 50% 0%,#ffffffaa 0,#efe7fa 60%,#efe7fa 100%);backdrop-filter:blur(6px);border-bottom:1px solid var(--ring)}
.container{max-width:1100px;margin:0 auto;padding:18px}
h1{margin:0;font-size:clamp(20px,4.6vw,40px);letter-spacing:.5px}

/* ì»¨íŠ¸ë¡¤ ë°•ìŠ¤ */
.toolbar{background:var(--panel);border:1px solid var(--ring);border-radius:16px;padding:14px;box-shadow:var(--shadow);display:flex;flex-wrap:wrap;gap:10px;align-items:center}
.btn{display:inline-flex;align-items:center;gap:6px;padding:9px 14px;border:1px solid var(--ring);border-radius:12px;background:#fff;cursor:pointer;color:var(--ink);} 
.btn:active{transform:translateY(1px)}
.chip{font-size:12px;padding:2px 8px;border-radius:999px;border:1px solid var(--ring);background:var(--chip);color:var(--muted)}

/* ê³µí†µ ì¹´ë“œ */
.card{width:var(--card-w);height:var(--card-h);background:#b7a4ea;border-radius:16px;padding:10px;border:6px solid #fff;box-shadow:var(--shadow);display:flex;flex-direction:column;justify-content:center;align-items:center}
.card small{display:block;margin-top:8px;color:#fff;letter-spacing:.12em}

/* ê²°ê³¼ ì˜ì—­ */
#stage{margin-top:14px;display:flex;flex-direction:column;gap:14px}
.spread{background:#fff;border:1px solid var(--ring);border-radius:18px;padding:16px;box-shadow:var(--shadow)}

/* 1/3/5 ê³µí†µ ë ˆì´ì•„ì›ƒ - ê°€ë¡œ ê³ ì •, í•œ í™”ë©´ì— ìˆ˜ë‚© */
.row{display:grid;grid-auto-rows:1fr;gap:var(--gap);justify-items:center}
.row.cols-1{grid-template-columns:repeat(1,minmax(0,1fr))}
.row.cols-3{grid-template-columns:repeat(3,minmax(0,1fr))}
.row.cols-5{grid-template-columns:repeat(5,minmax(0,1fr))}
.row .card{width:var(--spread-card);height:calc(var(--spread-card)*1.55)}

/* ì‹­ì ìŠ¤í”„ë ˆë“œ â€“ ê²¹ì¹¨ ë°©ì§€, box ì•ˆ ì •ì¤‘ì•™ */
.cross{display:grid;grid-template-columns:repeat(3,var(--spread-card));grid-template-rows:repeat(3,calc(var(--spread-card)*1.55));gap:var(--gap);justify-content:center}
.cross .slot{display:flex;align-items:center;justify-content:center}
.cross .slot:nth-child(2){grid-column:2}
.cross .slot:nth-child(3){grid-column:2;grid-row:2}
.cross .slot:nth-child(4){grid-column:1;grid-row:2}
.cross .slot:nth-child(5){grid-column:3;grid-row:2}
.cross .slot:nth-child(6){grid-column:2;grid-row:3}
.mini{font-weight:600;margin-top:8px}

/* ê·¸ë‘íƒ€ë¸”ë¡œ(9x4, 8x4+4) â€“ í•­ìƒ í•œ í™”ë©´ì— ìˆ˜ë‚©ë˜ë„ë¡ ì‘ì€ ì¹´ë“œ + íƒ€ì´í‹€ ìµœì†Œí™” */
.gt{display:flex;flex-direction:column;gap:10px}
.gt-grid{display:grid;gap:8px;justify-content:center}
.gt-grid.cols-9{grid-template-columns:repeat(9,var(--gt-card))}
.gt-grid.cols-8{grid-template-columns:repeat(8,var(--gt-card))}
.gt .gt-card{width:var(--gt-card);height:calc(var(--gt-card)*1.55);background:#b7a4ea;border:4px solid #fff;border-radius:12px;display:flex;align-items:center;justify-content:center;position:relative}
.gt .label{position:absolute;bottom:4px;left:0;right:0;text-align:center;color:#fff;font-size:10px;letter-spacing:.06em}

/* ì—ì„¼ìŠ¤ 4ì¥ ê°€ë¡œ */
.essence{display:grid;grid-template-columns:repeat(4,var(--gt-card));gap:8px;justify-content:center}

/* í†¤ ì¹© */
.tone{display:inline-flex;align-items:center;gap:6px;margin-right:6px}
.tone i{display:inline-block;width:10px;height:10px;border-radius:50%}
.tone.pos i{background:#3a7bff}
.tone.neg i{background:#f25b63}
.tone.neu i{background:#17b978}

/* ìš”ì•½ ë°•ìŠ¤ */
.summary{background:var(--panel);border:1px solid var(--ring);border-radius:14px;padding:12px}

@media (max-width:480px){
  :root{--spread-card:clamp(90px, 28vw, 130px);--gt-card:clamp(48px, 9vw, 72px)}
  .row.cols-5{grid-template-columns:repeat(5,minmax(0,1fr))}
}

  </style>
</head>
<body>
<header><div class="container"><h1>NAVI&HUI LENORMAND</h1></div></header>
<main class="container">
  <section class="toolbar">
    <label class="chip"><input id="qToggle" type="checkbox"> ì§ˆë¬¸ ì…ë ¥</label>
    <input id="qInput" type="search" placeholder="ì§ˆë¬¸(ì„ íƒ)" style="display:none;min-width:220px"><button class="btn" id="btn1">ğŸƒ 1ì¹´ë“œ</button>
<button class="btn" id="btn3">ğŸƒğŸƒğŸƒ 3ì¹´ë“œ</button>
<button class="btn" id="btn5">ğŸƒÃ—5 5ì¹´ë“œ</button>
<button class="btn" id="btnCross">â• ì‹­ì</button>
<button class="btn" id="btnGT94">ğŸ§© 9Ã—4</button>
<button class="btn" id="btnGT84">ğŸ§© 8Ã—4+4</button>

  </section>  <section id="stage"></section>
</main><script>
/*************************
 * ë°ì´í„°(ê°„ë‹¨ í‚¤ì›Œë“œ/í†¤)
 *************************/
const CARDS = [
  [1,'Rider','ê¸°ìˆ˜','ì†Œì‹Â·ë„ì°©','pos'],[2,'Clover','í´ë¡œë²„','ê¸°íšŒÂ·ìœ ì—°','pos'],[3,'Ship','ì„ ë°•','ì—¬í–‰Â·í™•ì¥','neu'],[4,'House','ì§‘','ê°€ì •Â·ì•ˆì •','pos'],[5,'Tree','ë‚˜ë¬´','ê±´ê°•Â·ì„±ì¥Â·ì‹œê°„','pos'],[6,'Cloud','êµ¬ë¦„','í˜¼ë€Â·ë¶ˆí™•ì‹¤','neg'],[7,'Snake','ë±€','ì¥ì• Â·ìœ í˜¹Â·ê¸°ë§Œ','neg'],[8,'Coffin','ê´€','ëÂ·ì „í™˜','neg'],[9,'Bouquet','ë¶€ì¼€','ê¸°ì¨Â·ì„ ë¬¼Â·í˜¸ì˜','pos'],[10,'Scythe','ë‚«','ë‹¨ì ˆÂ·ê²°ë‹¨','neg'],[11,'Whip','ì±„ì°','ê°ˆë“±Â·ë°˜ë³µ','neg'],[12,'Bird','ìƒˆ','ëŒ€í™”Â·ì—°ë½Â·ì†Œí†µ','pos'],[13,'Child','ì•„ì´','ìƒˆ ì‹œì‘Â·ìˆœìˆ˜','pos'],[14,'Fox','ì—¬ìš°','ì£¼ì˜Â·ì¼Â·ì˜ë¦¬í•¨','neu'],[15,'Bear','ê³°','ê¶Œìœ„Â·ìì›','neu'],[16,'Stars','ë³„','ë¹„ì „Â·í¬ë§','pos'],[17,'Stork','í™©ìƒˆ','ë³€í™”Â·ì´ë™','pos'],[18,'Dog','ê°œ','ì‹ ë¢°Â·ìš°ì •','pos'],[19,'Tower','íƒ‘','ë¶„ë¦¬Â·ê¸°ê´€','neu'],[20,'Garden','ì •ì›','ëª¨ì„Â·ê³µê°œ','pos'],[21,'Mountain','ì‚°','ì§€ì—°Â·ì¥ì• Â·ë²½','neg'],[22,'Crossroad','ê°ˆë¦¼ê¸¸','ì„ íƒÂ·ê²°ì •','neu'],[23,'Mice','ì¥','ì†Œëª¨Â·ë¶ˆì•ˆ','neg'],[24,'Heart','í•˜íŠ¸','ì‚¬ë‘Â·ì—´ì •','pos'],[25,'Ring','ë°˜ì§€','ê³„ì•½Â·ìˆœí™˜','pos'],[26,'Book','ì±…','ë¹„ë°€Â·í•™ìŠµ','neu'],[27,'Letter','í¸ì§€','ë¬¸ì„œÂ·ë©”ì¼','pos'],[28,'Man','ë‚¨ì„±','í•µì‹¬ ì¸ë¬¼(ë‚¨)','neu'],[29,'Woman','ì—¬ì„±','í•µì‹¬ ì¸ë¬¼(ì—¬)','neu'],[30,'Lily','ë°±í•©','í‰í™”Â·ì„±ìˆ™Â·íœ´ì‹','pos'],[31,'Sun','íƒœì–‘','ì„±ê³µÂ·ê°€ì‹œì„±Â·ì—ë„ˆì§€','pos'],[32,'Moon','ë‹¬','ëª…ì˜ˆÂ·ê°ì •','pos'],[33,'Key','ì—´ì‡ ','í•´ê²°Â·ì •ë‹µÂ·ëŒíŒŒêµ¬','pos'],[34,'Fish','ë¬¼ê³ ê¸°','ì¬ë¬¼Â·êµë¥˜Â·ê±°ë˜','pos'],[35,'Anchor','ë‹»','ì•ˆì •Â·ì§€ì†ì„±','pos'],[36,'Cross','ì‹­ìê°€','ê³ ë‚œÂ·ì‹ ë…Â·ì±…ì„','neg']
];

const byNo = Object.fromEntries(CARDS.map(([no,en,kr,kw,t])=>[no,{no,en,kr,kw,t}]))

function toneChip(t){
  const map={pos:['ê¸ì •','pos'],neg:['ë¶€ì •','neg'],neu:['ì¤‘ë¦½','neu']};
  const [label,cls]=map[t]||['ì¤‘ë¦½','neu'];
  return `<span class="tone ${cls}"><i></i>${label}</span>`
}

/********************* ìœ í‹¸ *********************/
function rand(n){return Math.floor(Math.random()*n)}
function draw(n){
  const deck=[...CARDS];
  const picked=[];
  while(picked.length<n && deck.length){
    const i = rand(deck.length);
    picked.push(deck.splice(i,1)[0]);
  }
  return picked.map(([no])=>byNo[no]);
}
function clearStage(){document.getElementById('stage').innerHTML=''}
function qText(){const i=document.getElementById('qInput');return (document.getElementById('qToggle').checked && i.value.trim())? i.value.trim():''}

/********************* ë Œë”ëŸ¬ *********************/
function cardEl(c,small=false){
  const w = small? 'var(--gt-card)':'var(--spread-card)';
  const h = small? 'calc(var(--gt-card)*1.55)':'calc(var(--spread-card)*1.55)';
  return `<figure class="card" style="width:${w};height:${h};"><img alt="${c.no}. ${c.en}" src="images/ë ˆë…¸ë¨¼ë“œ-${String(c.no).padStart(2,'0')}.png" style="width:100%;height:100%;object-fit:cover;border-radius:10px;"/><figcaption class="mini">${c.no}. ${c.en}</figcaption></figure>`
}

function renderList(list, cols){
  clearStage();
  const stage=document.getElementById('stage');
  const box=document.createElement('section');
  box.className='spread';
  box.innerHTML=`<div class="row cols-${cols}">${list.map(c=>cardEl(c)).join('')}</div>` + makeSummary(list);
  stage.appendChild(box);
}

function renderFive(){
  const picked=draw(5);
  clearStage();
  const stage=document.getElementById('stage');
  const box=document.createElement('section');
  box.className='spread';
  box.innerHTML=`<div class="row cols-5">${picked.map(c=>cardEl(c)).join('')}</div>` + makeSummary(picked,true);
  stage.appendChild(box);
}

function renderCross(){
  const [center,left,right,top,bottom]=draw(5);
  clearStage();
  const stage=document.getElementById('stage');
  const box=document.createElement('section');
  box.className='spread';
  box.innerHTML=`<div class="cross">
    <div class="slot"></div>
    <div class="slot">${cardEl(top)}</div>
    <div class="slot"></div>
    <div class="slot">${cardEl(left)}</div>
    <div class="slot">${cardEl(center)}</div>
    <div class="slot">${cardEl(right)}</div>
    <div class="slot"></div>
    <div class="slot">${cardEl(bottom)}</div>
    <div class="slot"></div>
  </div>` + makeSummary([center,top,left,right,bottom]);
  stage.appendChild(box);
}

/* ê·¸ë‘íƒ€ë¸”ë¡œ */
function renderGT(rows,cols,withEssence){
  const deck=[...CARDS].map(([no])=>byNo[no]);
  const grid=[]; // 2D
  for(let r=0;r<rows;r++){ grid[r]=[]; for(let c=0;c<cols;c++){ const i=r*cols+c; grid[r][c]=deck[i]; }}
  const flat=grid.flat();

  clearStage();
  const stage=document.getElementById('stage');
  const box=document.createElement('section');
  box.className='spread';

  // ì•ˆë‚´ í…ìŠ¤íŠ¸(ì•„ë˜ í™•ì¸)
  const guide=`<div class="summary" style="margin-bottom:8px">ì¹´ë“œë¥¼ ëˆŒëŸ¬ <strong>í‚¤ ì¹´ë“œ</strong>ì˜ ì£¼ìœ„ì¹´ë“œì™€ <strong>ë‚˜ì´íŒ…</strong>ì„ <u>ì•„ë˜</u>ì—ì„œ í™•ì¸í•˜ì„¸ìš”.</div>`

  let html = `<section class="gt">${guide}<div class="gt-grid ${cols===9?'cols-9':'cols-8'}">`;
  flat.forEach(c=>{ html+=`<figure class="gt-card" data-no="${c.no}"><img alt="${c.no}. ${c.en}" src="images/ë ˆë…¸ë¨¼ë“œ-${String(c.no).padStart(2,'0')}.png" style="width:100%;height:100%;object-fit:cover;border-radius:8px;"/><figcaption class="label">${c.no}</figcaption></figure>`});
  html+='</div>';

  if(withEssence){
    const essence = deck.slice(rows*cols, rows*cols+4);
    html+=`<div class="essence" style="margin-top:10px">${essence.map(c=>`<figure class="gt-card">${cardEl(c,true)}</figure>`).join('')}</div>`;
    html+=`<div class="summary" id="essTone"></div>`;
  }

  html+=`<div class="summary" id="gtDetail" style="margin-top:10px"></div></section>`;
  box.innerHTML=html;
  stage.appendChild(box);

  // í´ë¦­ ì´ë²¤íŠ¸ â€“ í‚¤ ì¹´ë“œ/ì£¼ìœ„/ë‚˜ì´íŒ…
  box.querySelectorAll('.gt-card').forEach(el=>{
    el.addEventListener('click',()=>{
      const n = Number(el.dataset.no);
      const info = keyInsight(n, rows, cols);
      document.getElementById('gtDetail').innerHTML = info;
    })
  })

  if(withEssence){
    const ess = deck.slice(rows*cols, rows*cols+4);
    const tone = toneCount(ess);
    document.getElementById('essTone').innerHTML = `ì—ì„¼ìŠ¤ í†¤: ${toneChip(tone.main)} (ê¸ì • ${tone.pos}/ ë¶€ì • ${tone.neg}/ ì¤‘ë¦½ ${tone.neu})`;
  }
}

/* í‚¤ì¹´ë“œ ì¸ì‚¬ì´íŠ¸ (ì£¼ìœ„+ë‚˜ì´íŒ… ëª©ë¡ë§Œ) */
function keyInsight(n, rows, cols){
  // ìœ„ì¹˜ êµ¬í•˜ê¸°
  const idx = n-1; // deck ìˆœì„œ = ë²ˆí˜¸ìˆœ
  const r = Math.floor(idx/cols), c = idx%cols;
  const around=[];
  const dirs=[[ -1, 0],[ 1, 0],[0,-1],[0, 1],[-1,-1],[-1,1],[1,-1],[1,1]]; // 8ë°©í–¥
  dirs.forEach(([dr,dc])=>{const rr=r+dr, cc=c+dc; if(rr>=0&&rr<rows&&cc>=0&&cc<cols){const no=rr*cols+cc+1; around.push(byNo[no]);}})
  // ë‚˜ì´íŒ…(ê¸°ì‚¬ ì´ë™) â€“ (Â±1,Â±2) (Â±2,Â±1)
  const knights=[[1,2],[2,1],[-1,2],[-2,1],[1,-2],[2,-1],[-1,-2],[-2,-1]];
  const knight=[];
  knights.forEach(([dr,dc])=>{const rr=r+dr, cc=c+dc; if(rr>=0&&rr<rows&&cc>=0&&cc<cols){const no=rr*cols+cc+1; knight.push(byNo[no]);}})
  const tone = toneCount([byNo[n],...around,...knight]);
  return `í‚¤ ì¹´ë“œ: <strong>${n}. ${byNo[n].en}</strong><br>ì£¼ìœ„ ì¹´ë“œ(${around.length}): ${around.map(x=>x.no).join(', ')}<br>ë‚˜ì´íŒ…(${knight.length}): ${knight.map(x=>x.no).join(', ')}<br>í†¤: ${toneChip(tone.main)} (ê¸ì • ${tone.pos}/ ë¶€ì • ${tone.neg}/ ì¤‘ë¦½ ${tone.neu})`;
}

/* í†¤ ì§‘ê³„ + ì´í‰ */
function toneCount(list){
  const cnt={pos:0,neg:0,neu:0};
  list.forEach(c=>cnt[c.t]++);
  const main = cnt.pos>=cnt.neg && cnt.pos>=cnt.neu ? 'pos' : (cnt.neg>=cnt.neu ? 'neg' : 'neu');
  return {...cnt,main}
}
function makeSummary(list, withAdvice){
  const cnt=toneCount(list);
  const tonetxt = {pos:'ìš°í˜¸ì ',neg:'ì£¼ì˜',neu:'ì¤‘ë¦½'}[cnt.main];
  const rows = list.map(c=>`â€¢ ${c.no}. ${c.en} â€” ${c.kw}`).join('<br>');
  const advice = cnt.main==='neg' ? 'ë¦¬ìŠ¤í¬ ê´€ë¦¬Â·ì¼ì • ì¬ê²€í† .' : (cnt.main==='pos' ? 'ë“¤ì–´ì˜¨ ì œì•ˆ/ì—°ë½ì„ í™œìš©í•´ ë³´ì„¸ìš”.' : 'ìƒí™© ê´€ì°°ê³¼ ì¶”ê°€ ë°ì´í„° í™•ë³´ê°€ ì¤‘ìš”í•©ë‹ˆë‹¤.');
  return `<div class="summary" style="margin-top:12px">
    <strong>ì „ì²´ í†¤:</strong> ${toneChip(cnt.main)} (ê¸ì • ${cnt.pos} / ë¶€ì • ${cnt.neg} / ì¤‘ë¦½ ${cnt.neu})<br>
    ${rows}<br>${withAdvice?`<br><strong>ê¶Œê³ :</strong> ${advice}`:''}
  </div>`
}

/********************* ì´ë²¤íŠ¸ ë°”ì¸ë”© *********************/
qToggle.addEventListener('change',()=>{qInput.style.display=qToggle.checked?'inline-block':'none'})
btn1.addEventListener('click',()=>renderList(draw(1),1))
btn3.addEventListener('click',()=>renderList(draw(3),3))
btn5.addEventListener('click',renderFive)
btnCross.addEventListener('click',renderCross)
btnGT94.addEventListener('click',()=>renderGT(4,9,false))
btnGT84.addEventListener('click',()=>renderGT(4,8,true))
</script>
</body>
</html>