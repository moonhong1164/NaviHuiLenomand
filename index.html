<!doctype html>
<html lang="ko">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>NAVI&HUI LENORMAND</title>
<style>
  :root{
    --bg:#efe9fb; --panel:#ffffff; --ink:#2b2240; --muted:#6f65a6;
    --shadow:0 10px 30px rgba(40,20,60,.08);
    --pos:#4c88ff; --neg:#e25566; --neu:#2ea66d; /* íŒŒë‘/ë¹¨ê°•/ì´ˆë¡ */
  }
  *{box-sizing:border-box}
  html,body{margin:0;background:var(--bg);color:var(--ink);font-family:Inter, Pretendard, Apple SD Gothic Neo, "ë§‘ì€ ê³ ë”•", sans-serif}
  h1{font-size:clamp(22px,3.6vw,40px);letter-spacing:.5px;margin:28px 18px 6px;font-weight:900}
  .wrap{max-width:980px;margin:0 auto;padding:0 16px 60px}

  /* ì»¨íŠ¸ë¡¤ë°” + ì§ˆë¬¸ì¹¸(ë³µêµ¬) */
  .toolbar{background:rgba(255,255,255,.65);backdrop-filter:blur(6px);border-radius:20px;padding:18px;margin:10px 0 20px;box-shadow:var(--shadow)}
  .row{display:flex;flex-wrap:wrap;gap:10px;align-items:center}
  .btn{border:none;border-radius:14px;padding:10px 16px;font-weight:700;background:#f1eeff;color:#4a3d93;cursor:pointer;box-shadow:0 4px 14px rgba(70,50,120,.08)}
  .btn:active{transform:translateY(1px)}
  .btn.g{background:#e8fff4;color:#0f7148}
  .ask{display:flex;gap:10px;align-items:center;margin-right:auto}
  .ask input[type="text"]{height:38px;padding:0 10px;border-radius:10px;border:1px solid #e6e0ff;width:240px;background:#fff}
  .hidden{display:none}

  .stage{display:grid;gap:16px}
  .panel{background:var(--panel);border-radius:18px;padding:18px;box-shadow:var(--shadow)}
  .note{color:var(--muted);font-weight:600}

  /* ì¹´ë“œ ê³µí†µ */
  .cards{display:flex;gap:16px;justify-content:center;flex-wrap:nowrap}
  .card-box{width:min(90px,24vw)}
  .card{position:relative;border-radius:16px;background:#ffffff;box-shadow:0 6px 16px rgba(50,20,90,.12);overflow:hidden}
  .card::before{content:"";display:block;padding-top:140%}
  .card img{position:absolute;inset:0;width:100%;height:100%;object-fit:cover}

  /* í†¤ í‘œì‹œ(ìƒ‰+ì´ëª¨ì§€) */
  .tone-row{display:flex;align-items:center;gap:8px;margin:.5rem 0}
  .dot{display:inline-block;width:12px;height:12px;border-radius:999px;vertical-align:-1px}
  .pos{background:var(--pos)} .neg{background:var(--neg)} .neu{background:var(--neu)}

  .summary{background:#faf9ff;border-radius:14px;padding:12px 14px;margin-top:10px}
  .summary ul{padding-left:18px;margin:8px 0}
  .summary li{margin:4px 0}

  /* ì‹­ì ìŠ¤í”„ë ˆë“œ (ê²¹ì¹¨ ë°©ì§€/ìë™ ì¶•ì†Œ) */
  .cross-area{
    position:relative;margin:12px auto;width:min(560px,92vw);height:min(90vh,122vw);
    --crossw:120px;
  }
  .cross-card{position:absolute;width:var(--crossw);height:calc(var(--crossw)*1.4)}

  /* ê·¸ë‘íƒ€ë¸”ë¡œ */
  .gt-grid{
    --gt-cols:9; display:grid; gap:6px; justify-items:center;
    grid-template-columns:repeat(var(--gt-cols),1fr);
  }
  .gt-grid .card-box{width:var(--gtw)}
</style>
</head>
<body>
<div class="wrap">
  <h1>NAVI&amp;HUI LENORMAND</h1>

  <!-- ë²„íŠ¼ + ì§ˆë¬¸ì¹¸ (ë³µêµ¬ëœ êµ¬ì„±/ìˆœì„œ) -->
  <div class="toolbar">
    <div class="row">
      <div class="ask">
        <label style="display:flex;align-items:center;gap:8px;font-weight:800">
          <input id="askOn" type="checkbox"> ì§ˆë¬¸ ì…ë ¥
        </label>
        <input id="askText" type="text" class="hidden" placeholder="ì§ˆë¬¸ì„ ì ì–´ ì£¼ì„¸ìš”" />
      </div>
      <button class="btn" id="b1">1ì¹´ë“œ</button>
      <button class="btn" id="b3">3ì¹´ë“œ</button>
      <button class="btn" id="b5">5ì¹´ë“œ</button>
      <button class="btn" id="bc">+ ì‹­ì</button>
      <button class="btn g" id="b94">9Ã—4</button>
      <button class="btn g" id="b84">8Ã—4+4</button>
    </div>
  </div>

  <div id="stage" class="stage"></div>
</div>

<script>
/* ==================== ë„¤ê°€ ì¤€ CARDSë¡œ êµì²´ ==================== */
const CARDS = [
  {num:1, code:"Rider", kr:"ê¸°ìˆ˜", key:"ì†Œì‹â€¢ì´ë™", add:"ë¹ ë¥¸ ë³€í™”Â·ì—°ë½ ë„ì°©", type:"positive"},
  {num:2, code:"Clover", kr:"í´ë¡œë²„", key:"í–‰ìš´â€¢ê¸°íšŒ", add:"ì§§ì€ ì°¬ìŠ¤Â·ì‹œë„ ì¢‹ìŒ", type:"positive"},
  {num:3, code:"Ship", kr:"ì„ ë°•", key:"ì—¬í–‰â€¢í™•ì¥", add:"ê´€ê³„Â·í™˜ê²½ ë³€í™”", type:"neutral"},
  {num:4, code:"House", kr:"ì§‘", key:"ê°€ì •â€¢ì•ˆì •", add:"ê¸°ë°˜ ë‹¤ì§€ê¸°", type:"neutral"},
  {num:5, code:"Tree", kr:"ë‚˜ë¬´", key:"ê±´ê°•â€¢ì„±ì¥", add:"ì¥ê¸° ì„±ì¥Â·íšŒë³µ", type:"positive"},
  {num:6, code:"Cloud", kr:"êµ¬ë¦„", key:"í˜¼ë€â€¢ë¶ˆí™•ì‹¤", add:"íŒë‹¨ ë³´ë¥˜Â·ì±™ê¸°ê¸°", type:"negative"},
  {num:7, code:"Snake", kr:"ë±€", key:"ìœ í˜¹â€¢ê¸°ë§Œ", add:"ê²‰ê³¼ì† ë‹¤ë¦„Â·ì£¼ì˜", type:"negative"},
  {num:8, code:"Coffin", kr:"ê´€", key:"ëâ€¢ì „í™˜", add:"ì •ë¦¬Â·ì¬ì¶œë°œ", type:"negative"},
  {num:9, code:"Bouquet", kr:"ë¶€ì¼€", key:"ì„ ë¬¼â€¢ê¸°ì¨", add:"í˜¸ì˜ ìƒìŠ¹", type:"positive"},
  {num:10, code:"Scythe", kr:"ë‚«", key:"ë‹¨ì ˆâ€¢ê²°ì •", add:"ë¹ ë¥¸ ì„ íƒ", type:"negative"},
  {num:11, code:"Whip", kr:"ì±„ì°", key:"ê°ˆë“±â€¢ë°˜ë³µ", add:"ë£¨í”„ ëŠê¸°", type:"negative"},
  {num:12, code:"Bird", kr:"ìƒˆ", key:"ëŒ€í™”â€¢ì†Œë¬¸", add:"ë§ ë§ì€ ì‹œê¸°", type:"neutral"},
  {num:13, code:"Child", kr:"ì•„ì´", key:"ìƒˆ ì‹œì‘â€¢ìˆœìˆ˜", add:"ì‘ì§€ë§Œ ì„±ì¥ í¼", type:"positive"},
  {num:14, code:"Fox", kr:"ì—¬ìš°", key:"ì¼â€¢ì˜ì‹¬", add:"ê³„ì•½Â·ì •ë³´ ì¬í™•ì¸", type:"neutral"},
  {num:15, code:"Bear", kr:"ê³°", key:"í˜â€¢ë³´í˜¸", add:"í›„ì›Â·ë¦¬ë”ì‹­", type:"positive"},
  {num:16, code:"Stars", kr:"ë³„", key:"í¬ë§â€¢ëª©í‘œ", add:"ë¹„ì „ ëª…í™•", type:"positive"},
  {num:17, code:"Stork", kr:"í™©ìƒˆ", key:"ë³€í™”â€¢ê°œì„ ", add:"ìŠµê´€ ì—…ë°ì´íŠ¸", type:"positive"},
  {num:18, code:"Dog", kr:"ê°œ", key:"ì‹ ë¢°â€¢ìš°ì •", add:"ë™ë§¹Â·íŒŒíŠ¸ë„ˆì‹­", type:"positive"},
  {num:19, code:"Tower", kr:"íƒ‘", key:"ì œë„â€¢ë…ë¦½", add:"í™€ë¡œì„œê¸°", type:"neutral"},
  {num:20, code:"Garden", kr:"ì •ì›", key:"ëª¨ì„â€¢ê³µê°œ", add:"ì¢‹ì€ í‰íŒ", type:"positive"},
  {num:21, code:"Mountain", kr:"ì‚°", key:"ì¥ì• â€¢ì§€ì—°", add:"ì‹œê°„ í•„ìš”", type:"negative"},
  {num:22, code:"Crossroad", kr:"ê°ˆë¦¼ê¸¸", key:"ì„ íƒâ€¢ê²°ì •", add:"ë°ì´í„° ë¹„êµ", type:"neutral"},
  {num:23, code:"Mice", kr:"ì¥", key:"ì†ì‹¤â€¢ì†Œëª¨", add:"ë¯¸ì„¸ëˆ„ìˆ˜ ì ê²€", type:"negative"},
  {num:24, code:"Heart", kr:"í•˜íŠ¸", key:"ì‚¬ë‘â€¢ê°ì •", add:"ê°ì • íšŒë³µ", type:"positive"},
  {num:25, code:"Ring", kr:"ë°˜ì§€", key:"ê³„ì•½â€¢ìˆœí™˜", add:"ì¥ê¸° ì»¤ë°‹", type:"neutral"},
  {num:26, code:"Book", kr:"ì±…", key:"ë¹„ë°€â€¢í•™ìŠµ", add:"ì •ë³´ ë¯¸ê³µê°œ", type:"neutral"},
  {num:27, code:"Letter", kr:"í¸ì§€", key:"ì—°ë½â€¢ë¬¸ì„œ", add:"ì¦ê±°Â·í†µë³´", type:"positive"},
  {num:28, code:"Man", kr:"ë‚¨ì„±", key:"í•µì‹¬ ì¸ë¬¼", add:"ì¤‘ì‹¬ ë‚¨ì„±", type:"neutral"},
  {num:29, code:"Woman", kr:"ì—¬ì„±", key:"í•µì‹¬ ì¸ë¬¼", add:"ì¤‘ì‹¬ ì—¬ì„±", type:"neutral"},
  {num:30, code:"Lily", kr:"ë°±í•©", key:"í‰í™”â€¢ì„±ìˆ™", add:"íœ´ì‹Â·í’ˆìœ„", type:"positive"},
  {num:31, code:"Sun", kr:"íƒœì–‘", key:"ì„±ê³µâ€¢í™œë ¥", add:"ê¸ì • ê²°ê³¼", type:"positive"},
  {num:32, code:"Moon", kr:"ë‹¬", key:"ëª…ì˜ˆâ€¢ê°ì •", add:"ê°ì • ë¦¬ë“¬", type:"positive"},
  {num:33, code:"Key", kr:"ì—´ì‡ ", key:"í•´ê²°â€¢ì •ë‹µ", add:"ëŒíŒŒêµ¬", type:"positive"},
  {num:34, code:"Fish", kr:"ë¬¼ê³ ê¸°", key:"ì¬ë¬¼â€¢êµë¥˜", add:"ê±°ë˜ ì¦ê°€", type:"neutral"},
  {num:35, code:"Anchor", kr:"ë‹»", key:"ì•ˆì •â€¢ê³ ì •", add:"ì§€ì†ì„±", type:"neutral"},
  {num:36, code:"Cross", kr:"ì‹­ìê°€", key:"ê³ ë‚œâ€¢ì‹ ë…", add:"ì±…ì„Â·ë²„í‹°ê¸°", type:"negative"},
];

/* ============ ì´ë¯¸ì§€ ê²½ë¡œ (ê¸°ë³¸ + í´ë°±) ============ */
function imgPath(num){
  const nn = String(num).padStart(2,'0');
  const name = `ë ˆë…¸ë¨¼ë“œ-${nn}.png`;
  return {primary:`images/${name}`, fallback:`img/lenormand/${name}`};
}
function imageTag(num, alt){
  const p = imgPath(num);
  return `<img src="${p.primary}" data-fallback="${p.fallback}" alt="${alt||''}">`;
}
function wireImgFallback(root){
  (root||document).querySelectorAll('img[data-fallback]').forEach(img=>{
    img.addEventListener('error', function onErr(){
      if(this.dataset.fallback && this.src!==this.dataset.fallback){ this.src=this.dataset.fallback; }
      else{ this.removeEventListener('error', onErr); }
    });
  });
}

/* ============ ìœ í‹¸/ê³µí†µ ë Œë” ============ */
const stage = document.getElementById('stage');
const askOn  = document.getElementById('askOn');
const askTxt = document.getElementById('askText');

askOn.addEventListener('change',()=>{
  if(askOn.checked){ askTxt.classList.remove('hidden'); askTxt.focus(); }
  else{ askTxt.classList.add('hidden'); askTxt.value=''; }
});

function clearAll(){ stage.innerHTML=''; }
function shuffle(a){ for(let i=a.length-1;i>0;i--){const j=Math.floor(Math.random()*(i+1));[a[i],a[j]]=[a[j],a[i]]} }
function pick(n){ const arr=[...CARDS]; shuffle(arr); return arr.slice(0,n); }

function toneKey(t){ return t==='positive'?'pos':(t==='negative'?'neg':'neu'); }
function toneEmoji(t){ return t==='positive'?'ğŸ”µ':(t==='negative'?'ğŸ”´':'ğŸŸ¢'); }
function toneText(t){ return t==='positive'?'ê¸ì •':(t==='negative'?'ë¶€ì •':'ì¤‘ë¦½'); }

function questionBlock(){
  const q = askOn.checked ? askTxt.value.trim() : '';
  return q ? `<div class="note" style="margin-bottom:8px"><b>ì§ˆë¬¸:</b> ${q}</div>` : '';
}

function cardBox(card){
  return `
    <div class="card-box">
      <div class="card">${imageTag(card.num, `${card.num}. ${card.code}`)}</div>
    </div>
  `;
}

function renderSummary(cards){
  let p=0,n=0,u=0;
  cards.forEach(c=>{ if(c.type==='positive')p++; else if(c.type==='negative')n++; else u++; });
  const badge = (p>n)?'positive':(n>p)?'negative':'neutral';
  const box = document.createElement('div');
  box.className = 'summary';
  box.innerHTML = `
    <div class="tone-row">
      <span class="dot ${toneKey(badge)}"></span>
      <b>${toneEmoji(badge)} ${toneText(badge)}</b>
      <span class="note"> (ê¸ì • ${p} / ë¶€ì • ${n} / ì¤‘ë¦½ ${u})</span>
    </div>
    <ul>
      ${cards.map(c=>`<li><b>${c.num}. ${c.code} (${c.kr})</b> â€” ${c.key} Â· ${c.add}</li>`).join('')}
    </ul>`;
  stage.appendChild(box);
}

/* ============ ìŠ¤í”„ë ˆë“œ ============ */
function r1(){
  clearAll();
  const sel = pick(1);
  const p = document.createElement('div'); p.className='panel';
  p.innerHTML = `${questionBlock()}<div class="cards">${sel.map(cardBox).join('')}</div>`;
  stage.appendChild(p); wireImgFallback(p); renderSummary(sel);
}
function r3(){
  clearAll();
  const sel = pick(3);
  const p = document.createElement('div'); p.className='panel';
  p.innerHTML = `${questionBlock()}<div class="cards">${sel.map(cardBox).join('')}</div>`;
  stage.appendChild(p); wireImgFallback(p); renderSummary(sel);
}
function r5(){
  clearAll();
  const sel = pick(5);
  const p = document.createElement('div'); p.className='panel';
  p.innerHTML = `${questionBlock()}<div class="cards">${sel.map(cardBox).join('')}</div>`;
  stage.appendChild(p); wireImgFallback(p); renderSummary(sel);
}

/* ì‹­ì: ì¤‘ì•™/ì¢Œ/ìš°/ìƒ/í•˜ ìë™ ì¶•ì†Œ ë°°ì¹˜ */
function rCross(){
  clearAll();
  const sel = pick(5);
  const [center,left,right,top,bottom] = [sel[2], sel[0], sel[1], sel[3], sel[4]];
  const wrap = document.createElement('div'); wrap.className='panel';
  wrap.innerHTML = `${questionBlock()}
    <div class="cross-area" id="cross">
      <div class="cross-card" id="C">${cardBox(center)}</div>
      <div class="cross-card" id="L">${cardBox(left)}</div>
      <div class="cross-card" id="R">${cardBox(right)}</div>
      <div class="cross-card" id="T">${cardBox(top)}</div>
      <div class="cross-card" id="B">${cardBox(bottom)}</div>
    </div>`;
  stage.appendChild(wrap);
  wireImgFallback(wrap);

  requestAnimationFrame(()=>{
    const area=document.getElementById('cross');
    const w=area.clientWidth,h=area.clientHeight, gap=10, side=14, vpad=14;
    const wBased=Math.floor((w-side*2-gap*2)/3);
    const hBased=Math.floor((h-vpad*2-gap*2)/4.2);
    const cw=Math.max(60,Math.min(110,Math.min(wBased,hBased)));
    area.style.setProperty('--crossw',`${cw}px`);
    const ch=Math.floor(cw*1.4);
    const cx=Math.floor(w/2), cy=Math.floor(h/2);
    const pos=(id,x,y)=>{const el=document.getElementById(id);el.style.left=x+"px";el.style.top=y+"px";el.style.transform="translate(-50%,-50%)";}
    pos("C",cx,cy); pos("L",cx-(cw+gap),cy); pos("R",cx+(cw+gap),cy); pos("T",cx,cy-(ch+gap)); pos("B",cx,cy+(ch+gap));
  });

  renderSummary([left,right,top,bottom,center]);
}

/* ê·¸ë‘íƒ€ë¸”ë¡œ (9x4 / 8x4+4) */
function fitGT(wrap,grid,cols){
  const pad=20;
  const w=wrap.clientWidth-pad*2;
  const maxW=Math.floor((w-(cols-1)*6)/cols);
  const cw=Math.max(48,Math.min(84,maxW));
  grid.style.setProperty('--gtw',`${cw}px`);
}
function rGT(mode){
  clearAll();
  const is8 = (mode==="8x4+4" || mode==="8x4e");
  const cols = is8 ? 8 : 9;
  const total = is8 ? 32 : 36;

  const pool=[...CARDS]; shuffle(pool);
  const main=pool.slice(0,total);
  const ess = is8 ? pool.slice(32) : [];

  const wrap=document.createElement('div'); wrap.className='panel'; wrap.id='gtW';
  const grid=document.createElement('div'); grid.className='gt-grid'; grid.style.setProperty('--gt-cols',cols);
  grid.innerHTML = main.map(c=>cardBox(c)).join('');
  wrap.innerHTML = `${questionBlock()}`;
  wrap.appendChild(grid);

  if(is8){
    const essBox=document.createElement('div'); essBox.className='summary'; 
    essBox.innerHTML = `<b>ì—ì„¼ìŠ¤ 4ì¥</b> â€” ${ess.map(c=>`${c.num}. ${c.code}`).join(' Â· ')}`;
    wrap.appendChild(essBox);
  }

  stage.appendChild(wrap);
  wireImgFallback(wrap);

  requestAnimationFrame(()=>{
    fitGT(wrap,grid,cols);
    const onR=()=>fitGT(wrap,grid,cols);
    if(!grid._bind){ window.addEventListener('resize',onR); grid._bind=true; }
  });
}

/* ë²„íŠ¼ ë°”ì¸ë”© (ìˆœì„œ ìœ ì§€) */
document.getElementById('b1').onclick = r1;
document.getElementById('b3').onclick = r3;
document.getElementById('b5').onclick = r5;
document.getElementById('bc').onclick = rCross;
document.getElementById('b94').onclick = ()=>rGT("9x4");
document.getElementById('b84').onclick = ()=>rGT("8x4+4");

/* ì´ˆê¸° ìë™ ì‹¤í–‰ ì—†ìŒ */
</script>
</body>
</html>
