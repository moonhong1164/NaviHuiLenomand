<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>NAVI&HUI LENORMAND</title>
<style>
  :root{
    --bg:#f6efff;--card:#fff;--ink:#2b1560;--shadow:rgba(0,0,0,.12);
    --pill:#ffffff;--pill-on:#dff3ff;
  }
  *{box-sizing:border-box}
  body{margin:0;background:var(--bg);font-family:ui-sans-serif,system-ui,'Apple SD Gothic Neo','Noto Sans KR',sans-serif;color:var(--ink)}
  .wrap{max-width:960px;margin:auto;padding:20px}
  h1{margin:8px 0 18px;text-align:center;font-size:34px;font-weight:800}
  .toolbar{background:var(--pill);border-radius:18px;box-shadow:0 6px 20px var(--shadow);padding:14px 16px;display:flex;flex-wrap:wrap;gap:10px;align-items:center;justify-content:center}
  .qbox{flex:1 1 320px;display:flex;gap:8px;align-items:center}
  .qbox input[type="text"]{flex:1;padding:10px 12px;border:1px solid #ded6f8;border-radius:12px;background:#fff}
  .btn{border:0;padding:10px 16px;border-radius:14px;background:#fff;box-shadow:0 3px 12px var(--shadow);cursor:pointer;font-weight:700}
  .btn:active{transform:translateY(1px)}
  .btn.on{background:var(--pill-on)}
  #stage{margin-top:18px;background:#fff;border-radius:16px;box-shadow:0 6px 18px var(--shadow);padding:16px}

  /* ì¹´ë“œ ê³µí†µ */
  .item{text-align:center;cursor:pointer}
  .card{width:120px;aspect-ratio:3/4;background:var(--card);border-radius:16px;box-shadow:0 4px 14px var(--shadow);display:flex;align-items:center;justify-content:center;margin:auto}
  .card img{width:92%;height:auto;border-radius:10px}
  .caption{margin-top:6px;text-align:center;font-size:13px;line-height:1.15}
  .tone{display:inline-block;margin-top:4px;padding:3px 8px;border-radius:999px;font-size:12px}
  .tone.pos{background:#e8f2ff} .tone.neu{background:#e7ffe8} .tone.neg{background:#ffe7e7}

  /* ìŠ¤í”„ë ˆë“œ */
  .row{display:flex;gap:14px;justify-content:center;align-items:flex-start;flex-wrap:nowrap}

  /* ì‹­ì: ê²¹ì¹¨ ì œê±°(ê²©ì) */
  .cross{display:grid;grid-template-columns:repeat(3,1fr);gap:12px;max-width:640px;margin:0 auto}
  .cross .card{width:100%;max-width:150px}

  /* 9x4 ê·¸ë‘íƒ€ë¸”ë¡œ â€“ ëª¨ë°”ì¼ì—ì„œë„ ê°€ë¡œ 9 ê³ ì • */
  .grand9x4{display:grid;grid-template-columns:repeat(9, minmax(0, 1fr));gap:8px}
  .grand9x4 .card{width:100%} /* ì…€ì— ë§ì¶° ìë™ ì¶•ì†Œ */

  /* 8x4+4: ìƒë‹¨ 8Ã—4 ê·¸ë¦¬ë“œ + í•˜ë‹¨ ì—ì„¼ìŠ¤ 4ì¥ ê°€ë¡œì¤„ */
  .grand8x4{display:grid;grid-template-columns:repeat(8, minmax(0,1fr));gap:8px}
  .essenceRow{display:grid;grid-template-columns:repeat(4, minmax(0,1fr));gap:10px;margin-top:12px}

  /* ì‘ì€ í™”ë©´ì—ì„œ ì¹´ë“œ ìë™ ì¶•ì†Œ */
  @media (max-width:460px){
    .card{width:86px}
    .cross .card{max-width:120px}
    .row{gap:10px}
  }

  .box{margin-top:14px;padding:12px;border:1px dashed #d7cfff;border-radius:12px;background:#fbf9ff}
  .muted{opacity:.7}
</style>
</head>
<body>
<div class="wrap">
  <h1>NAVI&HUI LENORMAND</h1>

  <div class="toolbar">
    <div class="qbox">
      <label><input id="useQ" type="checkbox" /> ì§ˆë¬¸ ì…ë ¥</label>
      <input id="qtext" type="text" placeholder="ì§ˆë¬¸ì„ ì ì–´ ì£¼ì„¸ìš”" />
    </div>
    <button class="btn" onclick="drawN(1,this)">1ì¹´ë“œ</button>
    <button class="btn" onclick="drawN(3,this)">3ì¹´ë“œ</button>
    <button class="btn" onclick="drawN(5,this)">5ì¹´ë“œ</button>
    <button class="btn" onclick="drawCross(this)">+ ì‹­ì</button>
    <button class="btn" onclick="drawGrand('9x4',this)">9x4</button>
    <button class="btn" onclick="drawGrand('8x4+4',this)">8x4+4</button>
  </div>

  <div id="stage"></div>
</div>

<script>
/* ===== ì¹´ë“œ ë°ì´í„° (Key ì¹´ë“œ key ì†ì„± ë³µêµ¬) ===== */
const CARDS = [
  {num:1, code:"Rider", kr:"ê¸°ìˆ˜", key:"ì†Œì‹â€¢ì´ë™", add:"ë¹ ë¥¸ ë³€í™”Â·ì—°ë½ ë„ì°©", type:"neutral"},
  {num:2, code:"Clover", kr:"í´ë¡œë²„", key:"í–‰ìš´â€¢ê¸°íšŒ", add:"ì§§ì€ ì°¬ìŠ¤Â·ì‹œë„ ì¢‹ìŒ", type:"negative"},
  {num:3, code:"Ship", kr:"ì„ ë°•", key:"ì—¬í–‰â€¢í™•ì¥", add:"ê´€ê³„Â·í™˜ê²½ ë³€í™”", type:"neutral"},
  {num:4, code:"House", kr:"ì§‘", key:"ê°€ì •â€¢ì•ˆì •", add:"ê¸°ë°˜ ë‹¤ì§€ê¸°", type:"neutral"},
  {num:5, code:"Tree", kr:"ë‚˜ë¬´", key:"ê±´ê°•â€¢ì„±ì¥", add:"ì¥ê¸° ì„±ì¥Â·íšŒë³µ", type:"neutral"},
  {num:6, code:"Cloud", kr:"êµ¬ë¦„", key:"í˜¼ë€â€¢íŒë‹¨ ë³´ë¥˜", add:"íŒë‹¨ ë³´ë¥˜Â·ì±™ê¸°ê¸°", type:"positive"},
  {num:7, code:"Snake", kr:"ë±€", key:"ìœ í˜¹â€¢ê¸°ë§Œ", add:"ê²‰ê³¼ì† ë‹¤ë¦„Â·ì£¼ì˜", type:"positive"},
  {num:8, code:"Coffin", kr:"ê´€", key:"ëâ€¢ì „í™˜", add:"ì •ë¦¬Â·ì¬ì¶œë°œ", type:"positive"},
  {num:9, code:"Bouquet", kr:"ë¶€ì¼€", key:"ì„ ë¬¼â€¢ê¸°ì¨", add:"í˜¸ì˜ ìƒìŠ¹", type:"negative"},
  {num:10, code:"Scythe", kr:"ë‚«", key:"ë‹¨ì ˆâ€¢ê²°ì •", add:"ë¹ ë¥¸ ì„ íƒ", type:"positive"},
  {num:11, code:"Whip", kr:"ì±„ì°", key:"ê°ˆë“±â€¢ë°˜ë³µ", add:"ë£¨í”„ ëŠê¸°", type:"positive"},
  {num:12, code:"Birds", kr:"ìƒˆ", key:"ëŒ€í™”â€¢ì†Œë¬¸", add:"ë§ ë§ì€ ì‹œê¸°", type:"neutral"},
  {num:13, code:"Child", kr:"ì•„ì´", key:"ìƒˆ ì‹œì‘â€¢ìˆœìˆ˜", add:"ì‘ì§€ë§Œ ì„±ì¥ í¼", type:"negative"},
  {num:14, code:"Fox", kr:"ì—¬ìš°", key:"ì¼â€¢ì˜ì‹¬", add:"ê³„ì•½Â·ì •ë³´ ì¬í™•ì¸", type:"neutral"},
  {num:15, code:"Bear", kr:"ê³°", key:"í˜â€¢ë³´í˜¸", add:"í›„ì›Â·ë¦¬ë”ì‹­", type:"neutral"},
  {num:16, code:"Stars", kr:"ë³„", key:"í¬ë§â€¢ëª©í‘œ", add:"ë¹„ì „ ëª…í™•", type:"negative"},
  {num:17, code:"Stork", kr:"í™©ìƒˆ", key:"ë³€í™”â€¢ê°œì„ ", add:"ìŠµê´€ ì—…ë°ì´íŠ¸", type:"neutral"},
  {num:18, code:"Dog", kr:"ê°œ", key:"ì‹ ë¢°â€¢ìš°ì •", add:"ë™ë§¹Â·íŒŒíŠ¸ë„ˆì‹­", type:"negative"},
  {num:19, code:"Tower", kr:"íƒ‘", key:"ì œë„â€¢ë…ë¦½", add:"í™€ë¡œì„œê¸°", type:"neutral"},
  {num:20, code:"Garden", kr:"ì •ì›", key:"ëª¨ì„â€¢ê³µê°œ", add:"ì¢‹ì€ í‰íŒ", type:"neutral"},
  {num:21, code:"Mountain", kr:"ì‚°", key:"ì¥ì• â€¢ì§€ì—°", add:"ì‹œê°„ í•„ìš”", type:"positive"},
  {num:22, code:"Crossroad", kr:"ê°ˆë¦¼ê¸¸", key:"ì„ íƒâ€¢ê²°ì •", add:"ë°ì´í„° ë¹„êµ", type:"neutral"},
  {num:23, code:"Mice", kr:"ì¥", key:"ì†ì‹¤â€¢ì†Œëª¨", add:"ë¯¸ì„¸ëˆ„ìˆ˜ ì ê²€", type:"positive"},
  {num:24, code:"Heart", kr:"í•˜íŠ¸", key:"ì‚¬ë‘â€¢ê°ì •", add:"ê°ì • íšŒë³µ", type:"negative"},
  {num:25, code:"Ring", kr:"ë°˜ì§€", key:"ê³„ì•½â€¢ìˆœí™˜", add:"ì¥ê¸° ì»¤ë°‹", type:"negative"},
  {num:26, code:"Book", kr:"ì±…", key:"ë¹„ë°€â€¢í•™ìŠµ", add:"ì •ë³´ ë¯¸ê³µê°œ", type:"neutral"},
  {num:27, code:"Letter", kr:"í¸ì§€", key:"ì—°ë½â€¢ë¬¸ì„œ", add:"ì¦ê±°Â·í†µë³´", type:"neutral"},
  {num:28, code:"Man", kr:"ë‚¨ì„±", key:"í•µì‹¬ ì¸ë¬¼", add:"ì¤‘ì‹¬ ë‚¨ì„±", type:"neutral"},
  {num:29, code:"Woman", kr:"ì—¬ì„±", key:"í•µì‹¬ ì¸ë¬¼", add:"ì¤‘ì‹¬ ì—¬ì„±", type:"neutral"},
  {num:30, code:"Lily", kr:"ë°±í•©", key:"í‰í™”â€¢ì„±ìˆ™", add:"íœ´ì‹Â·í’ˆìœ„", type:"neutral"},
  {num:31, code:"Sun", kr:"íƒœì–‘", key:"ì„±ê³µâ€¢í™œë ¥", add:"ê¸ì • ê²°ê³¼", type:"negative"},
  {num:32, code:"Moon", kr:"ë‹¬", key:"ëª…ì˜ˆâ€¢ê°ì •", add:"ê°ì • ë¦¬ë“¬", type:"negative"},
  {num:33, code:"Key", kr:"ì—´ì‡ ", key2:"í•´ê²°â€¢ì‹œì‘", add:"ëŒíŒŒêµ¬", type:"negative"},
  {num:34, code:"Fish", kr:"ë¬¼ê³ ê¸°", key:"ì¬ë¬¼â€¢êµë¥˜", add:"ê±°ë˜ ì¦ê°€", type:"negative"},
  {num:35, code:"Anchor", kr:"ë‹»", key:"ì•ˆì •â€¢ê³ ì •", add:"ì§€ì†ì„±", type:"negative"},
  {num:36, code:"Cross", kr:"ì‹­ìê°€", key:"ê³ ë‚œâ€¢ì‹ ë…", add:"ì±…ì„Â·ë²„í‹°ê¸°", type:"positive"},
];

/* ===== ì´ë¯¸ì§€ ë¡œë” (ë ˆë…¸ë¨¼ë“œ-01.png ê·œì¹™ ìš°ì„ ) ===== */
const IMG_CANDIDATES = ['','cards/','images/','img/'];
const EXT_CANDIDATES = ['.png','.webp','.jpg','.PNG','.JPG'];
const pad2=n=>String(n).padStart(2,'0');
function makeImg(num){
  const img=document.createElement('img');
  img.dataset.num=num; img.dataset.try=0;
  img.src=encodeURI(`ë ˆë…¸ë¨¼ë“œ-${pad2(num)}.png`);
  img.onerror=function(){ tryNext(this); };
  return img;
}
function tryNext(img){
  let t=+img.dataset.try; const num=img.dataset.num;
  const total=IMG_CANDIDATES.length*EXT_CANDIDATES.length;
  if(t>=total){ img.onerror=null; return; }
  const p=IMG_CANDIDATES[Math.floor(t/EXT_CANDIDATES.length)];
  const e=EXT_CANDIDATES[t%EXT_CANDIDATES.length];
  img.dataset.try=t+1;
  img.src=encodeURI(`${p}ë ˆë…¸ë¨¼ë“œ-${pad2(num)}${e}`);
}

/* ===== ìœ í‹¸ ===== */
function toneBadge(t){
  if(t==='negative') return '<span class="tone pos">ğŸ”µ ê¸ì •</span>';
  if(t==='positive') return '<span class="tone neg">ğŸ”´ ë¶€ì •</span>';
  return '<span class="tone neu">ğŸŸ¢ ì¤‘ë¦½</span>';
}
function tile(c,click=null){
  const root=document.createElement('div'); root.className='item';
  const card=document.createElement('div'); card.className='card';
  card.appendChild(makeImg(c.num));
  root.appendChild(card);
  const cap=document.createElement('div'); cap.className='caption';
  cap.innerHTML=`<b>${c.num}. ${c.code}</b><br>${toneBadge(c.type)}<br>${c.key}<br><span class="muted">${c.add}</span>`;
  root.appendChild(cap);
  if(click) root.onclick=click;
  return root;
}
function shuffle(a){return a.map(v=>[Math.random(),v]).sort((x,y)=>x[0]-y[0]).map(v=>v[1]);}
function setOn(btn){document.querySelectorAll('.btn').forEach(b=>b.classList.remove('on')); if(btn) btn.classList.add('on');}

const stage=document.getElementById('stage');

/* ===== ìŠ¤í”„ë ˆë“œë“¤ ===== */
function drawN(n,btn){
  setOn(btn);
  const pick=shuffle([...CARDS]).slice(0,n);
  stage.innerHTML='';
  const row=document.createElement('div'); row.className='row';
  pick.forEach(c=>row.appendChild(tile(c)));
  stage.appendChild(row);
}

function drawCross(btn){
  setOn(btn);
  const cs=shuffle([...CARDS]).slice(0,5);
  stage.innerHTML='';
  const grid=document.createElement('div'); grid.className='cross';
  // ìƒ
  grid.appendChild(document.createElement('div'));
  grid.appendChild(tile(cs[0]));
  grid.appendChild(document.createElement('div'));
  // ì¤‘
  grid.appendChild(tile(cs[1]));
  grid.appendChild(tile(cs[2]));
  grid.appendChild(tile(cs[3]));
  // í•˜
  grid.appendChild(document.createElement('div'));
  grid.appendChild(tile(cs[4]));
  grid.appendChild(document.createElement('div'));
  stage.appendChild(grid);
}

function drawGrand(kind,btn){
  setOn(btn);
  const arr=shuffle([...CARDS]); // 36ì¥
  stage.innerHTML='';

  if(kind==='9x4'){
    const grid=document.createElement('div'); grid.className='grand9x4'; grid.id='grand';
    arr.forEach((c,i)=> grid.appendChild(tile(c,()=>showKey(i,arr,'9x4'))));
    stage.appendChild(grid);
  }else{ // 8x4+4
    const grid=document.createElement('div'); grid.className='grand8x4'; grid.id='grand84';
    const first32=arr.slice(0,32), essence=arr.slice(32); // ë§ˆì§€ë§‰ 4ì¥ ì—ì„¼ìŠ¤
    first32.forEach((c,i)=> grid.appendChild(tile(c,()=>showKey(i,first32,'8x4'))));
    stage.appendChild(grid);

    const es=document.createElement('div'); es.className='essenceRow'; es.id='essenceRow';
    essence.forEach(c=> es.appendChild(tile(c)));
    stage.appendChild(es);
  }

  // ìƒì„¸ íŒ¨ë„(í‚¤ì¹´ë“œ í¬í•¨) â€“ í‚¤ì¹´ë“œ ì´ë¯¸ì§€ê°€ í™•ì‹¤íˆ ë³´ì´ë„ë¡ ìŠ¬ë¡¯ í›„ DOM ì‚½ì…
  const box=document.createElement('div'); box.className='box'; box.id='detail';
  box.innerHTML='<b>í‚¤ ì¹´ë“œë¥¼ ëˆ„ë¥´ë©´</b> ì•„ë˜ì— í‚¤ ì¹´ë“œì™€ ì£¼ìœ„/ë‚˜ì´íŒ…ì„ ë³´ì—¬ì¤ë‹ˆë‹¤.<div id="keycard-slot" style="margin-top:8px"></div>';
  stage.appendChild(box);
}

/* í‚¤ì¹´ë“œ ìƒì„¸ */
function showKey(idx,arr,mode){
  const cols = (mode==='9x4'?9:8);
  const rows = 4;
  const r=Math.floor(idx/cols), c=idx%cols;

  const around=[];
  function pushIf(rr,cc){
    if(rr>=0&&rr<rows&&cc>=0&&cc<cols){
      around.push(arr[rr*cols+cc]);
    }
  }
  // 4ë°©
  pushIf(r,c-1); pushIf(r,c+1); pushIf(r-1,c); pushIf(r+1,c);
  // ë‚˜ì´íŒ…
  const knight=[];
  [[-1,-2],[-2,-1],[+1,-2],[+2,-1],[+1,+2],[+2,+1],[-1,+2],[-2,+1]].forEach(([dr,dc])=>{
    const rr=r+dr, cc=c+dc;
    if(rr>=0&&rr<rows&&cc>=0&&cc<cols) knight.push(arr[rr*cols+cc]);
  });

  const key = arr[idx];
  const detail=document.getElementById('detail');
  detail.innerHTML = `
    <div style="display:flex;gap:16px;align-items:flex-start;flex-wrap:wrap">
      <div style="min-width:120px">
        <div id="keycard-slot"></div>
        <div class="caption" style="text-align:left">
          <b>${key.num}. ${key.code}</b><br>
          ${toneBadge(key.type)}<br>
          ${key.key}<br><span class="muted">${key.add}</span>
        </div>
      </div>
      <div>
        <b>ì£¼ìœ„ ì¹´ë“œ</b><br>
        ${around.map(x=>`${x.num}. ${x.code} â€” ${x.key} ${toneBadge(x.type)}`).join('<br>') || 'â€”'}
        <div style="height:10px"></div>
        <b>ë‚˜ì´íŒ…</b><br>
        ${knight.map(x=>`${x.num}. ${x.code} â€” ${x.key} ${toneBadge(x.type)}`).join('<br>') || 'â€”'}
      </div>
    </div>
  `;
  // ì‹¤ì œ ì¹´ë“œ ì´ë¯¸ì§€ DOMì„ ìŠ¬ë¡¯ì— ì‚½ì…(ì´ë¯¸ì§€ê°€ í™•ì‹¤íˆ ë³´ì´ê²Œ)
  const slot=document.getElementById('keycard-slot');
  const node=tile(key); slot.appendChild(node.firstChild); // ì¹´ë“œë§Œ ë„£ìŒ
}

/* ì´ˆê¸° ë¡œë“œ: ì•„ë¬´ ìŠ¤í”„ë ˆë“œë„ ìë™ ì‹¤í–‰í•˜ì§€ ì•ŠìŒ */
</script>
</body>
</html>
