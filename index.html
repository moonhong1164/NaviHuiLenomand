<!doctype html>
<html lang="ko">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>NAVI&HUI LENORMAND</title>
<style>
  :root{
    --bg:#efe7ff; --ink:#33284a; --panel:#ffffffcc;
    --chip-pos:#2b6cf6; --chip-neg:#d83a3a; --chip-neu:#14a44d;
    --shadow:0 8px 24px rgba(64,30,120,.18);
    --gap:14px; --cardw:120px;
  }
  *{box-sizing:border-box}
  body{margin:0;background:var(--bg);color:var(--ink);
       font-family:ui-sans-serif,system-ui,Apple SD Gothic Neo,"Noto Sans KR",Segoe UI,Roboto,Helvetica,Arial}
  h1{margin:18px 16px 8px;font-size:clamp(22px,4.5vw,40px);font-weight:900;letter-spacing:.5px}
  /* ìƒë‹¨ ë²„íŠ¼ë°” */
  .toolbar{max-width:1100px;margin:8px auto 12px;padding:14px;border-radius:18px;
           background:rgba(255,255,255,.66);backdrop-filter:blur(6px);box-shadow:var(--shadow);
           display:flex;flex-wrap:wrap;gap:10px}
  .btn{appearance:none;border:0;padding:10px 16px;border-radius:14px;background:#fff;
       box-shadow:0 2px 8px rgba(0,0,0,.08);font-weight:800;cursor:pointer}
  .btn:hover{transform:translateY(-1px)}
  /* ë¬´ëŒ€ */
  .board{max-width:1100px;margin:0 auto;padding:10px 12px 40px}
  .panel{background:var(--panel);border-radius:20px;padding:16px;box-shadow:var(--shadow);margin:14px 0}
  .hint{font-weight:800;opacity:.85}
  /* ì¹´ë“œ ê³µí†µ */
  .card-box{width:var(--cardw)}
  .card{width:100%;aspect-ratio:3/4;border-radius:18px;background:#c7b1f1;
        overflow:hidden;box-shadow:0 6px 18px rgba(34,11,70,.18);display:flex;align-items:center;justify-content:center}
  .card img{width:100%;height:100%;object-fit:cover;display:block}
  .cap{margin-top:6px;font-size:13px;line-height:1.35}
  .cap small{opacity:.75}
  /* í†¤ ì¹© */
  .tone-chip{display:inline-flex;align-items:center;gap:6px;font-weight:900;padding:6px 10px;border-radius:999px;color:#fff;margin-bottom:6px}
  .tone-pos{background:var(--chip-pos)} .tone-neg{background:var(--chip-neg)} .tone-neu{background:var(--chip-neu)}
  /* 1/3/5: ê°€ë¡œ ê³ ì • í•œ í™”ë©´ */
  .spread-wrap{display:flex;justify-content:center}
  .spread{display:flex;gap:var(--gap);flex-wrap:nowrap;justify-content:center}
  /* ì‹­ì */
  .cross{position:relative;width:min(92vw,560px);height:min(88vw,540px)}
  .cross .card-box{position:absolute;width:min(26vw,140px)}
  .cross .center{left:50%;top:50%;transform:translate(-50%,-50%)}
  .cross .north{left:50%;top:6%;transform:translate(-50%,0)}
  .cross .south{left:50%;bottom:6%;transform:translate(-50%,0)}
  .cross .west{left:6%;top:50%;transform:translate(0,-50%)}
  .cross .east{right:6%;top:50%;transform:translate(0,-50%)}
  /* ê·¸ë‘íƒ€ë¸”ë¡œ */
  .gt-wrap{background:#fff;border-radius:18px;padding:14px;box-shadow:var(--shadow)}
  .gt-grid{--gtw:80px;display:grid;gap:10px;justify-content:center;grid-template-columns:repeat(var(--cols),var(--gtw))}
  .gt-grid .card-box{width:var(--gtw)}
  .ess-row{display:flex;gap:10px;justify-content:center;flex-wrap:nowrap;margin-top:10px}
  /* ì´í‰ */
  .summary{background:#fff;border-radius:16px;padding:14px;box-shadow:var(--shadow)}
  .summary .title{font-weight:900;margin-bottom:6px}
  .summary ul{margin:8px 0 0 18px;padding:0}
  .divider{height:1px;background:linear-gradient(90deg,#0000,#0003,#0000);margin:10px 0}
  /* ë°˜ì‘í˜• ì¶•ì†Œ */
  @media (max-width:1000px){:root{--cardw:110px}}
  @media (max-width:820px){ :root{--cardw:100px}}
  @media (max-width:680px){ :root{--cardw:94px}}
  @media (max-width:560px){ :root{--cardw:88px}}
</style>
</head>
<body>
<h1>NAVI&HUI LENORMAND</h1>

<div class="toolbar">
  <button class="btn" data-spread="one">1ì¹´ë“œ</button>
  <button class="btn" data-spread="three">3ì¹´ë“œ</button>
  <button class="btn" data-spread="five">5ì¹´ë“œ</button>
  <button class="btn" data-spread="cross">+ ì‹­ì</button>
  <button class="btn" data-spread="gt9x4">ğŸ§© 9Ã—4</button>
  <button class="btn" data-spread="gt8x4e">ğŸ§© 8Ã—4+4</button>
</div>

<div class="board">
  <div id="hint" class="panel hint" style="display:none;"></div>
  <div id="stage" class="panel"></div>
  <div id="summary" class="panel summary" style="display:none;"></div>
  <div id="inspect" class="panel" style="display:none;"></div>
</div>

<!-- (ì„ íƒ) add.jsë¥¼ ë³„ë„ íŒŒì¼ë¡œ ì“´ë‹¤ë©´, ì´ íŒŒì¼ë³´ë‹¤ ë¨¼ì € ë¡œë“œí•˜ì„¸ìš”.
<script src="add.js"></script> -->

<script>
/* ====== ì¹´ë“œ ë©”íƒ€ ====== */
const NAMES={1:"Rider(ê¸°ìˆ˜)",2:"Clover(í´ë¡œë²„)",3:"Ship(ì„ ë°•)",4:"House(ì§‘)",5:"Tree(ë‚˜ë¬´)",6:"Cloud(êµ¬ë¦„)",7:"Snake(ë±€)",8:"Coffin(ê´€)",9:"Bouquet(ë¶€ì¼€)",10:"Scythe(ë‚«)",11:"Whip(ì±„ì°)",12:"Bird(ìƒˆ)",13:"Child(ì•„ì´)",14:"Fox(ì—¬ìš°)",15:"Bear(ê³°)",16:"Stars(ë³„)",17:"Stork(í™©ìƒˆ)",18:"Dog(ê°œ)",19:"Tower(íƒ‘)",20:"Garden(ì •ì›)",21:"Mountain(ì‚°)",22:"Crossroad(ê°ˆë¦¼ê¸¸)",23:"Mice(ì¥)",24:"Heart(í•˜íŠ¸)",25:"Ring(ë°˜ì§€)",26:"Book(ì±…)",27:"Letter(í¸ì§€)",28:"Man(ë‚¨ì„±)",29:"Woman(ì—¬ì„±)",30:"Lily(ë°±í•©)",31:"Sun(íƒœì–‘)",32:"Moon(ë‹¬)",33:"Key(ì—´ì‡ )",34:"Fish(ë¬¼ê³ ê¸°)",35:"Anchor(ë‹»)",36:"Cross(ì‹­ìê°€)"};
const KW={1:"ì†Œì‹Â·ì†ë„",2:"ê¸°íšŒÂ·ì‘ì€ í–‰ìš´",3:"ì—¬í–‰Â·í™•ì¥",4:"ì•ˆì •Â·ê°€ì •",5:"ê±´ê°•Â·ì„±ì¥",6:"í˜¼ë€Â·íŒë‹¨ ë³´ë¥˜",7:"ì¥ì• Â·ìœ í˜¹",8:"ëÂ·ì „í™˜",9:"ê¸°ì¨Â·ì„ ë¬¼Â·í˜¸ì˜",10:"ì ˆë‹¨Â·ê²°ë‹¨",11:"ê°ˆë“±Â·ë°˜ë³µ",12:"ëŒ€í™”Â·ì—°ë½",13:"ìƒˆ ì‹œì‘Â·ìˆœìˆ˜",14:"ì£¼ì˜Â·ì§€í˜œ",15:"ê¶Œìœ„Â·ìì›",16:"ëª…ì˜ˆÂ·ì¸ì •",17:"ë³€í™”Â·ì´ë™",18:"ì‹ ë¢°Â·ìš°ì •",19:"ê¸°ê´€Â·ê±°ë¦¬ë‘ê¸°",20:"ëª¨ì„Â·ê³µê°œ",21:"ì§€ì—°Â·ë²½",22:"ì„ íƒÂ·ê²°ì •",23:"ì†Œëª¨Â·ë¶ˆì•ˆ",24:"ì‚¬ë‘Â·ì—´ì •",25:"ê³„ì•½Â·ìˆœí™˜",26:"ë¹„ë°€Â·í•™ìŠµ",27:"ë¬¸ì„œÂ·ë©”ì¼",28:"í•µì‹¬ ì¸ë¬¼(ë‚¨ì„±)",29:"í•µì‹¬ ì¸ë¬¼(ì—¬ì„±)",30:"í‰í™”Â·ì„±ìˆ™",31:"ì„±ê³µÂ·ì—ë„ˆì§€",32:"ëª…ì˜ˆÂ·ê°ì •",33:"í•´ê²°Â·ì •ë‹µ",34:"ì¬ë¬¼Â·êµí™˜",35:"ì•ˆì •Â·ì§€ì†ì„±",36:"ê³ ë‚œÂ·ì‹ ë…Â·ì±…ì„"};
/* ì„ íƒ: ì™¸ë¶€ add.js(ìƒì„¸ í•´ì„) ë³‘í•© */
window.ADD = window.ADD || {}; // { 1:[...], 2:[...], ... }

/* ====== ìœ í‹¸ ====== */
function imgSrc(id){return `images/ë ˆë…¸ë¨¼ë“œ-${String(id).padStart(2,'0')}.png`;}
function shuffle(a){for(let i=a.length-1;i>0;i--){const j=(Math.random()*(i+1))|0;[a[i],a[j]]=[a[j],a[i]]}return a}
function pick(n){const ids=[...Array(36)].map((_,i)=>i+1);shuffle(ids);return ids.slice(0,n)}
const POS=new Set([2,3,4,5,9,12,14,15,16,17,18,20,22,24,25,26,27,30,31,32,33,34,35]);
const NEG=new Set([6,7,8,10,11,21,23,36]);
function toneOf(id){if(POS.has(id))return"positive";if(NEG.has(id))return"negative";return"neutral"}
function chipHtml(t){if(typeof t==="number")t=toneOf(t);
  if(t==="positive")return'<span class="tone-chip tone-pos">ğŸ”µ ê¸ì •</span>';
  if(t==="negative")return'<span class="tone-chip tone-neg">ğŸ”´ ë¶€ì •</span>';
  return'<span class="tone-chip tone-neu">ğŸŸ¢ ì¤‘ë¦½</span>';}
function toneCount(ids){return ids.reduce((a,id)=>{a[toneOf(id)]++;return a},{positive:0,negative:0,neutral:0})}
function domTone(c){if(c.positive>=c.negative&&c.positive>=c.neutral)return"positive";if(c.negative>=c.positive&&c.negative>=c.neutral)return"negative";return"neutral"}
function addFirstLine(id){const v=window.ADD[id];if(!v)return"";return Array.isArray(v)?(v[0]||""):v}
function capHtml(id){const add=addFirstLine(id);
  return `<div class="cap">${chipHtml(id)}<div><b>${id}. ${NAMES[id]||""}</b></div><div><small>${KW[id]||""}</small></div>${add?`<div style="opacity:.85;margin-top:2px;">${add}</div>`:""}</div>`}
function kwBullets(ids){return ids.map(id=>`<li><b>${id}. ${NAMES[id]||""}</b> â€” ${KW[id]||""}</li>`).join("")}
function addBullets(ids){return ids.map(id=>{const a=addFirstLine(id);return a?`<li><b>${id}.</b> ${a}</li>`:""}).join("")}

/* ====== ê³µí†µ DOM ====== */
const stage=document.getElementById("stage");
const summary=document.getElementById("summary");
const hint=document.getElementById("hint");
const inspect=document.getElementById("inspect");
function clearAll(){stage.innerHTML="";summary.style.display="none";summary.innerHTML="";hint.style.display="none";inspect.style.display="none";inspect.innerHTML=""}
function renderSummary(ids, note){
  const cnt=toneCount(ids); const dom=domTone(cnt);
  const addRows=addBullets(ids);
  summary.style.display="block";
  summary.innerHTML=`<div class="title">${chipHtml(dom)} (ê¸ì • ${cnt.positive} / ë¶€ì • ${cnt.negative} / ì¤‘ë¦½ ${cnt.neutral})</div>
                     <ul>${kwBullets(ids)}</ul>
                     ${addRows?`<div class="divider"></div><div class="title">ìš”ì•½(ADD)</div><ul>${addRows}</ul>`:""}
                     ${note?`<div class="divider"></div><div><b>ê¶Œê³ :</b> ${note}</div>`:""}`;
}

/* ====== 1/3/5 ====== */
function renderLinear(n){
  clearAll(); const ids=pick(n);
  const box=document.createElement("div"); box.className="spread-wrap";
  box.innerHTML=`<div class="spread">${ids.map(id=>`
      <div class="card-box"><div class="card"><img src="${imgSrc(id)}" alt=""></div>${capHtml(id)}</div>
  `).join("")}</div>`;
  stage.appendChild(box);
  renderSummary(ids, n===5?"ë“¤ì–´ì˜¨ ì œì•ˆ/ì—°ë½ì„ ì ê·¹ í™œìš©í•´ ë³´ì„¸ìš”.":"");
}

/* ====== ì‹­ì ====== */
function renderCross(){
  clearAll();
  const [center,north,south,west,east]=pick(5); const ids=[center,north,south,west,east];
  const wrap=document.createElement("div"); wrap.className="spread-wrap";
  wrap.innerHTML=`<div class="cross">
    <div class="card-box center"><div class="card"><img src="${imgSrc(center)}"></div>${capHtml(center)}</div>
    <div class="card-box north"><div class="card"><img src="${imgSrc(north)}"></div>${capHtml(north)}</div>
    <div class="card-box south"><div class="card"><img src="${imgSrc(south)}"></div>${capHtml(south)}</div>
    <div class="card-box west"><div class="card"><img src="${imgSrc(west)}"></div>${capHtml(west)}</div>
    <div class="card-box east"><div class="card"><img src="${imgSrc(east)}"></div>${capHtml(east)}</div>
  </div>`;
  stage.appendChild(wrap);
  renderSummary(ids,"ìƒí™©ì„ ê°ê´€í™”í•˜ê³  ì¶”ê°€ ë°ì´í„°ë¥¼ í™•ë³´í•˜ì„¸ìš”.");
}

/* ====== ê·¸ë‘íƒ€ë¸”ë¡œ(9Ã—4 / 8Ã—4+4) ====== */
function renderGT(mode){ // "9x4" | "8x4e"
  clearAll();
  const ids=[...Array(36)].map((_,i)=>i+1); shuffle(ids);
  const is8x4e=(mode==="8x4e");
  const cols=is8x4e?8:9, total=is8x4e?32:36;
  const main=ids.slice(0,total), essence=is8x4e?ids.slice(32):[];
  const wrap=document.createElement("div"); wrap.className="gt-wrap";
  const grid=document.createElement("div"); grid.className="gt-grid"; grid.style.setProperty("--cols",cols);

  // ëª¨ë°”ì¼ ì¶•ì†Œ
  grid.style.setProperty("--gtw", innerWidth<440?"58px":(innerWidth<560?"64px":"80px"));

  main.forEach((id,idx)=>{
    const el=document.createElement("div"); el.className="card-box";
    el.innerHTML=`<div class="card"><img src="${imgSrc(id)}"></div>`;
    el.title=`${rowcol(idx,cols)}  ${id}. ${NAMES[id]||""}`;
    el.addEventListener("click",()=>onKey(main,idx,cols,id));
    grid.appendChild(el);
  });

  const head=document.createElement("div");
  head.className="hint"; head.style.marginBottom="10px";
  head.innerHTML='ì¹´ë“œë¥¼ ëˆŒëŸ¬ <b>í‚¤ ì¹´ë“œ</b>ì˜ <b>ì£¼ìœ„ ì¹´ë“œ</b>ì™€ <b>ë‚˜ì´íŒ…</b>ì„ <b>ì•„ë˜</b>ì—ì„œ í™•ì¸í•˜ì„¸ìš”.';
  wrap.appendChild(head); wrap.appendChild(grid);

  if(is8x4e){
    const essRow=document.createElement("div"); essRow.className="ess-row";
    essence.forEach(id=>{
      const b=document.createElement("div"); b.className="card-box";
      b.innerHTML=`<div class="card"><img src="${imgSrc(id)}"></div>${capHtml(id)}`;
      essRow.appendChild(b);
    });
    const essWrap=document.createElement("div"); essWrap.className="panel";
    essWrap.innerHTML='<div class="hint" style="margin-bottom:10px">ì—ì„¼ìŠ¤ 4ì¥</div>';
    essWrap.appendChild(essRow); wrap.appendChild(essWrap);

    const essSummary=document.createElement("div"); essSummary.id="essSummary"; essSummary.className="summary";
    wrap.appendChild(essSummary);
    renderEssSummary(essence);
  }

  stage.appendChild(wrap);
  hint.style.display="block"; hint.textContent="í‚¤ ì¹´ë“œë¥¼ ì„ íƒí•˜ë©´ ì•„ë˜ì— ìƒì„¸ê°€ í‘œì‹œë©ë‹ˆë‹¤.";
  inspect.style.display="block"; inspect.innerHTML='<div class="hint">í‚¤ ì¹´ë“œë¥¼ ëˆŒëŸ¬ ìƒì„¸ë¥¼ í™•ì¸í•˜ì„¸ìš”.</div>';
}
function rowcol(idx,cols){const r=Math.floor(idx/cols)+1,c=(idx%cols)+1;return `${r}í–‰ ${c}ì—´`}
function aroundIdx(idx,cols,total){
  const r=Math.floor(idx/cols),c=idx%cols,ds=[[-1,-1],[-1,0],[-1,1],[0,-1],[0,1],[1,-1],[1,0],[1,1]],out=[];
  ds.forEach(([dr,dc])=>{const rr=r+dr,cc=c+dc; const k=rr*cols+cc; if(rr>=0&&cc>=0&&k>=0&&k<total) out.push(k)});
  return out;
}
function knightIdx(idx,cols,total){
  const r=Math.floor(idx/cols),c=idx%cols,ds=[[-2,-1],[-2,1],[-1,-2],[-1,2],[1,-2],[1,2],[2,-1],[2,1]],out=[];
  ds.forEach(([dr,dc])=>{const rr=r+dr,cc=c+dc; const k=rr*cols+cc; if(rr>=0&&cc>=0&&k>=0&&k<total) out.push(k)});
  return out;
}
function onKey(main,idx,cols,id){
  const around=aroundIdx(idx,cols,main.length).map(i=>main[i]);
  const knights=knightIdx(idx,cols,main.length).map(i=>main[i]);
  inspect.style.display="block";
  inspect.innerHTML=`
    <div class="hint" style="margin-bottom:10px">í‚¤ ì¹´ë“œ: <b>${id}. ${NAMES[id]||""}</b> â€” ${KW[id]||""}</div>
    <div class="spread" style="gap:10px;flex-wrap:wrap">
      <div class="card-box"><div class="card"><img src="${imgSrc(id)}"></div>${capHtml(id)}</div>
    </div>
    <div class="divider"></div>
    <div class="hint">ì£¼ìœ„ ì¹´ë“œ</div>
    <div class="spread" style="gap:10px;flex-wrap:wrap">
      ${around.map(v=>`<div class="card-box"><div class="card"><img src="${imgSrc(v)}"></div>${capHtml(v)}</div>`).join("")}
    </div>
    <div class="divider"></div>
    <div class="hint">ë‚˜ì´íŒ…</div>
    <div class="spread" style="gap:10px;flex-wrap:wrap">
      ${knights.map(v=>`<div class="card-box"><div class="card"><img src="${imgSrc(v)}"></div>${capHtml(v)}</div>`).join("")}
    </div>`;
}
function renderEssSummary(ids){
  const box=document.getElementById("essSummary"); if(!box)return;
  const cnt=toneCount(ids), dom=domTone(cnt);
  box.style.display="block";
  box.innerHTML=`<div class="title">ì—ì„¼ìŠ¤ í†¤: ${chipHtml(dom)} (ê¸ì • ${cnt.positive} / ë¶€ì • ${cnt.negative} / ì¤‘ë¦½ ${cnt.neutral})</div>
                 <ul>${kwBullets(ids)}</ul>
                 ${addBullets(ids)?`<div class="divider"></div><div class="title">ìš”ì•½(ADD)</div><ul>${addBullets(ids)}</ul>`:""}`;
}

/* ====== ì´ë²¤íŠ¸ ====== */
document.querySelectorAll(".btn").forEach(b=>{
  b.addEventListener("click",()=>{
    const t=b.dataset.spread;
    if(t==="one") return renderLinear(1);
    if(t==="three") return renderLinear(3);
    if(t==="five") return renderLinear(5);
    if(t==="cross") return renderCross();
    if(t==="gt9x4") return renderGT("9x4");
    if(t==="gt8x4e") return renderGT("8x4e");
  });
});
/* ì§„ì… ì‹œ ë¹ˆ í™”ë©´ */
clearAll();
</script>
</body>
</html>