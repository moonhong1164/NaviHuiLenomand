<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>NABY&MOONHONG LENORMAND ORACLE</title>
  <meta name="description" content="ë ˆë…¸ë¨¼ë“œ 36ì¥ ì¹´ë“œ: ê²€ìƒ‰, 1/3ì¹´ë“œ ë½‘ê¸°, ì§ˆë¬¸ ì…ë ¥"/>
  <style>
    :root{
      --bg:#0b0f14; --panel:#121823; --panel2:#0f141d; --text:#e8eef6; --muted:#9bb0c9; --ring:#334056;
      --chip:#1a2332; --shadow:0 10px 30px rgba(0,0,0,.45);
    }
    *{box-sizing:border-box}
    body{margin:0;background:var(--bg);color:var(--text);font-family:system-ui, -apple-system, Segoe UI, Roboto, sans-serif}
    header{position:sticky;top:0;z-index:10;background:rgba(10,15,22,.82);backdrop-filter:blur(8px);border-bottom:1px solid var(--ring)}
    .container{max-width:1150px;margin:0 auto;padding:16px}
    h1{margin:0;font-size:20px}

    /* Buttons & inputs */
    .btn{display:inline-flex;align-items:center;gap:6px;padding:8px 12px;border-radius:10px;border:1px solid var(--ring);background:var(--panel);color:var(--text);cursor:pointer;text-decoration:none;font-size:14px}
    input[type="search"],input[type="text"],select{width:100%;padding:10px 12px;margin:8px 0;border-radius:10px;border:1px solid var(--ring);background:var(--panel2);color:var(--text)}
    .chip{display:inline-flex;align-items:center;gap:6px;padding:2px 8px;border:1px solid var(--ring);border-radius:999px;background:var(--chip);color:var(--muted);font-size:12px}

    /* Card list */
    .grid{display:grid;gap:14px;padding:14px;grid-template-columns:repeat(auto-fill,minmax(250px,1fr))}
    .card{background:var(--panel2);border:1px solid var(--ring);border-radius:12px;padding:12px}
    .img-box{width:100%;aspect-ratio:3/4;background:#000;border-radius:12px;overflow:hidden;display:flex;align-items:center;justify-content:center;border:1px solid var(--ring)}
    .img-box img{width:100%;height:100%;object-fit:contain}
    .row{display:flex;gap:8px;align-items:center;flex-wrap:wrap}

    /* Draw box */
    .drawbox{background:var(--panel);border:1px solid var(--ring);border-radius:12px;padding:14px;margin:16px 0;box-shadow:var(--shadow)}
    .draw-result{margin-top:12px;display:grid;gap:12px}
    .card-mini{background:var(--panel2);border:1px solid var(--ring);border-radius:12px;padding:10px}
    .draw-result.triple{grid-template-columns:repeat(3,1fr);gap:10px}
    @media (max-width:600px){.draw-result.triple .card-mini{padding:8px}}

    footer{color:var(--muted);padding:40px 16px;text-align:center;border-top:1px solid var(--ring)}
  
    /* ===== Grand Tableau styles ===== */
    .gt-box{margin:18px 0;padding:14px;border:1px solid var(--ring);border-radius:12px;background:var(--panel);box-shadow:var(--shadow)}
    .gt-grid{display:grid;gap:8px}
    .gt-grid.cols-9{grid-template-columns:repeat(9,1fr)}
    .gt-grid.cols-8{grid-template-columns:repeat(8,1fr)}
    .gt-bottom4{display:grid;grid-template-columns:repeat(4,1fr);gap:8px;max-width:800px;margin:8px auto 0}
    .gt-cell{position:relative;background:var(--panel2);border:1px solid var(--ring);border-radius:10px;padding:6px}
    .gt-cell .img-box{aspect-ratio:3/4;background:#000;border:1px solid var(--ring);border-radius:8px;margin-bottom:6px}
    .gt-meta{font-size:12px;color:var(--muted)}
    .housechip{position:absolute;top:6px;left:6px;font-size:11px;padding:2px 6px;border-radius:999px;border:1px solid var(--ring);background:rgba(10,15,22,.8);color:#c7d7ee}
    @media (max-width:900px){.gt-grid.cols-9{grid-template-columns:repeat(6,1fr)}.gt-grid.cols-8{grid-template-columns:repeat(6,1fr)}.gt-bottom4{grid-template-columns:repeat(4,1fr)}}
    @media (max-width:640px){.gt-grid.cols-9{grid-template-columns:repeat(4,1fr)}.gt-grid.cols-8{grid-template-columns:repeat(4,1fr)}.gt-bottom4{grid-template-columns:repeat(4,1fr)}}
  
    /* === 5ì¹´ë“œ ì „ìš© ìƒ‰ìƒ/ì´ëª¨ì§€ ë°°ì§€ & ë ˆì´ì•„ì›ƒ === */
    .card-positive{border:2px solid #4cc3ff}
    .card-negative{border:2px solid #ff6b6b}
    .card-neutral{border:2px solid #2ee072}
    .type-badge{position:absolute;top:6px;right:6px;padding:2px 6px;border-radius:999px;font-size:12px;background:rgba(0,0,0,.45)}
    .card-mini{position:relative}
    .draw-result.five{display:grid;grid-template-columns:repeat(5,minmax(120px,1fr));gap:10px;overflow-x:auto}
    #drawSummary{margin-top:12px;padding:10px;border:1px dashed var(--ring);border-radius:10px;color:var(--muted)}
  </style>
</head>
<body>
<header><div class="container"><h1>NABY LENORMAND ORACLE</h1></div></header>
<main class="container">
  <section class="drawbox">
    <div class="draw-actions" style="display:flex;flex-wrap:wrap;gap:10px;align-items:center">
      <label class="chip"><input id="toggleQ" type="checkbox"> ì§ˆë¬¸ ì…ë ¥</label>
      <input id="inputQ" type="text" placeholder="ì§ˆë¬¸ì„ ì…ë ¥í•˜ì„¸ìš” (ì„ íƒ)" style="width:100%;margin:8px 0;display:none;padding:10px;border-radius:10px;border:1px solid var(--ring);background:var(--panel2);color:var(--text)">

      <!-- âœ… ë²„íŠ¼ 1/3/5 + ê·¸ë‘ë”°ë¸”ë¡œ 9x4 / 8x4+4 -->
      <button class="btn" id="btn1">ğŸƒ 1ì¹´ë“œ</button>
      <button class="btn" id="btn3">ğŸƒğŸƒğŸƒ 3ì¹´ë“œ</button>
      <button class="btn" id="btn5">ğŸƒğŸƒğŸƒğŸƒğŸƒ 5ì¹´ë“œ</button>
      <button class="btn" id="btnGT94">ğŸ§© ê·¸ë‘ë”°ë¸”ë¡œ 9Ã—4</button>
      <button class="btn" id="btnGT84">ğŸ§© ê·¸ë‘ë”°ë¸”ë¡œ 8Ã—4ï¼‹4</button>
    </div>
    <div id="qBox" style="margin-top:6px;color:var(--muted)"></div>
    <div id="drawArea" class="draw-result"></div>
    <div id="drawSummary" class="hidden"></div>
  </section>

  <button class="btn" id="toggleList">ğŸ“‚ ì¹´ë“œ ì „ì²´ ë³´ê¸°</button>
  <input id="search" type="search" placeholder="ì¹´ë“œ ì´ë¦„/í•œê¸€/ë²ˆí˜¸ ê²€ìƒ‰">
  <div id="grid" class="grid" style="display:none"></div>
  
  <!-- Grand Tableau Section -->
  <section class="gt-box">
    <div class="row" style="gap:10px;align-items:center">
      <span class="chip">ê·¸ë‘ë”°ë¸”ë¡œ</span>
      <button id="btnGT94" class="btn">ğŸ§© 9Ã—4 í¼ì¹˜ê¸°</button>
      <button id="btnGT84" class="btn">ğŸ§© 8Ã—4ï¼‹4 í¼ì¹˜ê¸°</button>
      <label class="chip"><input id="showHouses" type="checkbox" checked> í•˜ìš°ìŠ¤ ë²ˆí˜¸ í‘œì‹œ</label>
    </div>
    <div id="gtArea" style="margin-top:12px"></div>
  </section>

</main>
<footer>
  ìë£Œ ì¶œì²˜: NABY LENORMAND ORACLE<br>ì œì‘ : ë‚˜ë¹„ğŸ¦‹, ì›”í™ğŸŒ™
</footer>

<script>
// ===== ì¹´ë“œ ë°ì´í„° =====
// ì´ë¯¸ì§€ íŒŒì¼ëª… í˜•ì‹: images/ë ˆë…¸ë¨¼ë“œ-1.png ~ images/ë ˆë…¸ë¨¼ë“œ-36.png
const CARDS = [
  {num:1,  code:"Rider",     kr:"ê¸°ìˆ˜",     key:"ì†Œì‹â€¢ì´ë™",             add:"ë¹ ë¥¸ ë³€í™”ì˜ ì‹ í˜¸. ë©”ì‹œì§€/ì—°ë½ì´ ê³§ ë„ì°©.",            type:"positive"},
  {num:2,  code:"Clover",    kr:"í´ë¡œë²„",   key:"í–‰ìš´â€¢ê¸°íšŒ",             add:"ì§§ì§€ë§Œ ë°˜ì§ì´ëŠ” ì°¬ìŠ¤. ê°€ë³ê²Œ ì‹œë„í•´ ë³´ê¸°.",          type:"positive"},
  {num:3,  code:"Ship",      kr:"ì„ ë°•",     key:"ì—¬í–‰â€¢í™•ì¥",             add:"í™˜ê²½/ê´€ê³„ì˜ í° ì „í™˜. ì‹œì•¼ë¥¼ ë„“í ë•Œ.",              type:"neutral"},
  {num:4,  code:"House",     kr:"ì§‘",       key:"ê°€ì •â€¢ì•ˆì •",             add:"ê¸°ë°˜ ë‹¤ì§€ê¸°. ë£¨í‹´ê³¼ ì•ˆì „ë§ ì¬ì •ë¹„.",                type:"neutral"},
  {num:5,  code:"Tree",      kr:"ë‚˜ë¬´",     key:"ê±´ê°•â€¢ì„±ì¥",             add:"ì²œì²œíˆ ë¿Œë¦¬ë‚´ë¦¼. ì¥ê¸° ê´€ì ì—ì„œ ì ‘ê·¼.",              type:"positive"},
  {num:6,  code:"Cloud",     kr:"êµ¬ë¦„",     key:"í˜¼ë€â€¢ë¶ˆí™•ì‹¤",           add:"ì •ë³´ê°€ íë¦¼. ëª…í™•í•´ì§ˆ ë•Œê¹Œì§€ ë³´ë¥˜/ì ê²€.",            type:"negative"},
  {num:7,  code:"Snake",     kr:"ë±€",       key:"ìœ í˜¹â€¢ê¸°ë§Œ",             add:"ê²‰ê³¼ ì†ì´ ë‹¤ë¥¼ ìˆ˜ ìˆìŒ. ì§€í˜œë¡­ê²Œ ìš°íšŒ.",            type:"negative"},
  {num:8,  code:"Coffin",    kr:"ê´€",       key:"ëâ€¢ì „í™˜",               add:"í•œ ì£¼ê¸°ì˜ ì¢…ê²°. ì •ë¦¬ í›„ ì¬ì¶œë°œ ì¤€ë¹„.",              type:"negative"},
  {num:9,  code:"Bouquet",   kr:"ë¶€ì¼€",     key:"ì„ ë¬¼â€¢ê¸°ì¨",             add:"ê°ì‚¬ì˜ í‘œí˜„ì´ í–‰ìš´ì„ í‚¤ì›€. ë§¤ë ¥/í˜¸ì˜ ìƒìŠ¹.",        type:"positive"},
  {num:10, code:"Scythe",    kr:"ë‚«",       key:"ë‹¨ì ˆâ€¢ê²°ì •",             add:"ë¹ ë¥¸ ì ˆë‹¨. ê³¼ê°í•œ ì„ íƒê³¼ ìœ„í—˜ ê´€ë¦¬ê°€ ê´€ê±´.",        type:"negative"},
  {num:11, code:"Whip",      kr:"ì±„ì°",     key:"ê°ˆë“±â€¢ë°˜ë³µ",             add:"ë…¼ìŸ/ë£¨í”„ ëŠê¸°. ì—ë„ˆì§€ ì†Œëª¨ ì¤„ì´ê¸°.",              type:"negative"},
  {num:12, code:"Bird",      kr:"ìƒˆ",       key:"ëŒ€í™”â€¢ì†Œë¬¸",             add:"ë§ì´ ë§ì€ ì‹œê¸°. ë©”ì‹œì§€ ê´€ë¦¬/íŒ©íŠ¸ ì²´í¬.",            type:"neutral"},
  {num:13, code:"Child",     kr:"ì•„ì´",     key:"ìƒˆ ì‹œì‘â€¢ìˆœìˆ˜",           add:"ê°€ë³ê²Œ ì‹œì‘. ì‘ì§€ë§Œ ì„±ì¥ì„±ì´ í¼.",                  type:"positive"},
  {num:14, code:"Fox",       kr:"ì—¬ìš°",     key:"ì¼/ëŠ¥ë ¥â€¢ì˜ì‹¬",          add:"ì‹¤ë¦¬ì ìœ¼ë¡œ ëŒ€ì‘. ê³„ì•½/ì •ë³´ ì¬í™•ì¸.",                type:"neutral"},
  {num:15, code:"Bear",      kr:"ê³°",       key:"í˜â€¢ë³´í˜¸",               add:"ë¦¬ë”/í›„ì›ì ë“±ì¥. ì¬ì •/ìì› ê´€ë¦¬ ê°•í™”.",            type:"positive"},
  {num:16, code:"Stars",     kr:"ë³„",       key:"í¬ë§â€¢ëª©í‘œ",             add:"ì¥ê¸° ë¹„ì „ í´ë¦¬ì–´. ë„¤íŠ¸ì›Œí¬/ì˜¨ë¼ì¸ ìš´ ì¢‹ìŒ.",        type:"positive"},
  {num:17, code:"Stork",     kr:"í™©ìƒˆ",     key:"ë³€í™”â€¢ê°œì„ ",             add:"ì´ë™/ê°œí¸ ì‹œì¦Œ. ìŠµê´€ì„ ì¢‹ì€ ìª½ìœ¼ë¡œ ì—…ë°ì´íŠ¸.",     type:"positive"},
  {num:18, code:"Dog",       kr:"ê°œ",       key:"ì‹ ë¢°â€¢ìš°ì •",             add:"ë™ë§¹ ê°•í™”. ë„ì›€ì„ ì£¼ê³ ë°›ëŠ” íŒŒíŠ¸ë„ˆì‹­.",              type:"positive"},
  {num:19, code:"Tower",     kr:"íƒ‘",       key:"ì œë„â€¢ë…ë¦½",             add:"ê³µì  ì˜ì—­/ê·œì¹™. í™€ë¡œì„œê¸°ì™€ ê²½ê³„ ì„¤ì •.",            type:"neutral"},
  {num:20, code:"Garden",    kr:"ì •ì›",     key:"ëª¨ì„â€¢ê³µê°œ",             add:"ì»¤ë®¤ë‹ˆí‹°/í™ë³´ì— ìœ ë¦¬. ì˜¤í”ˆ ë„¤íŠ¸ì›Œí‚¹.",              type:"positive"},
  {num:21, code:"Mountain",  kr:"ì‚°",       key:"ì¥ì• â€¢ì§€ì—°",             add:"ì‹œê°„ì´ ë” í•„ìš”. ìš°íšŒë¡œ/ëŒ€ì²´ í”Œëœ ë§ˆë ¨.",            type:"negative"},
  {num:22, code:"Crossroad", kr:"ê°ˆë¦¼ê¸¸",   key:"ì„ íƒâ€¢ê²°ì •",             add:"ë³µìˆ˜ ì˜µì…˜ ë¹„êµ. ë°ì´í„° ê¸°ë°˜ ì˜ì‚¬ê²°ì •.",             type:"neutral"},
  {num:23, code:"Mice",      kr:"ì¥",       key:"ì†ì‹¤â€¢ì†Œëª¨",             add:"ìƒˆëŠ” êµ¬ë© ë§‰ê¸°. ê±´ê°•/ìì‚° â€˜ë¯¸ì„¸ëˆ„ìˆ˜â€™ ì ê²€.",        type:"negative"},
  {num:24, code:"Heart",     kr:"í•˜íŠ¸",     key:"ì‚¬ë‘â€¢ê°ì •",             add:"ì§„ì‹¬ì´ í†µí•˜ëŠ” ë•Œ. ì—´ì •/ê¸°ì¨ íšŒë³µ.",                type:"positive"},
  {num:25, code:"Ring",      kr:"ë°˜ì§€",     key:"ê³„ì•½â€¢ìˆœí™˜",             add:"í•©ì˜/ì•½ì†ì˜ ì‹œê¸°. ì¥ê¸°ì  ì»¤ë°‹ í™•ì¸.",              type:"neutral"},
  {num:26, code:"Book",      kr:"ì±…",       key:"ë¹„ë°€â€¢í•™ìŠµ",             add:"ìë£Œ ë¦¬ì„œì¹˜. ì•„ì§ ê³µê°œë˜ì§€ ì•Šì€ ì •ë³´.",            type:"neutral"},
  {num:27, code:"Letter",    kr:"í¸ì§€",     key:"ì—°ë½â€¢ë¬¸ì„œ",             add:"ì„œë©´ ì¦ê±° í™•ë³´. ì œì•ˆ/í•©ê²©í†µì§€ ê°€ëŠ¥ì„±.",            type:"positive"},
  {num:28, code:"Man",       kr:"ë‚¨ì„±",     key:"í•µì‹¬ ì¸ë¬¼(ë‚¨)",         add:"í•´ë‹¹ ë‚¨ì„±ì´ ì‚¬ê±´ì˜ í‚¤ë¥¼ ì¥ .",                      type:"neutral"},
  {num:29, code:"Woman",     kr:"ì—¬ì„±",     key:"í•µì‹¬ ì¸ë¬¼(ì—¬)",         add:"í•´ë‹¹ ì—¬ì„±ì´ ì‚¬ê±´ì˜ í‚¤ë¥¼ ì¥ .",                      type:"neutral"},
  {num:30, code:"Lily",      kr:"ë°±í•©",     key:"í‰í™”â€¢ì„±ìˆ™",             add:"í’ˆìœ„/ì „ë¬¸ì„±. ì„±ìˆ™í•œ í•©ì˜ì™€ íœ´ì‹.",                  type:"positive"},
  {num:31, code:"Sun",       kr:"íƒœì–‘",     key:"ì„±ê³µâ€¢í™œë ¥",             add:"ëª…í™•í•˜ê³  ê¸ì •ì  ê²°ê³¼. ìì‹ ê° ìƒìŠ¹.",                type:"positive"},
  {num:32, code:"Moon",      kr:"ë‹¬",       key:"ëª…ì˜ˆâ€¢ê°ì •",             add:"ì¸ì •/ë¸Œëœë”©. ê°ì •ê³¼ ë¦¬ë“¬ ê´€ë¦¬.",                    type:"positive"},
  {num:33, code:"Key",       kr:"ì—´ì‡ ",     key:"í•´ê²°â€¢ì •ë‹µ",             add:"ëŒíŒŒêµ¬ ë°œê²¬. ë¬¸ì„ ì—¬ëŠ” ê²°ì •ì  ì—´ì‡ .",                type:"positive"},
  {num:34, code:"Fish",      kr:"ë¬¼ê³ ê¸°",   key:"ì¬ë¬¼â€¢êµë¥˜",             add:"í˜„ê¸ˆíë¦„/ê±°ë˜ ì¦ê°€. ë…ë¦½ì„± ê°•í™”.",                  type:"neutral"},
  {num:35, code:"Anchor",    kr:"ë‹»",       key:"ì•ˆì •â€¢ê³ ì •",             add:"ì§€ì†ê°€ëŠ¥ì„±. ì¼ê´€ëœ ë£¨í‹´ì´ í˜ì´ ë¨.",                type:"neutral"},
  {num:36, code:"Cross",     kr:"ì‹­ìê°€",   key:"ê³ ë‚œâ€¢ì‹ ë…",             add:"ë¶€ë‹´/ì±…ì„. ë¯¿ìŒìœ¼ë¡œ ë²„í‹°ëŠ” ì‹œê°„.",                  type:"negative"}
];

// ===== DOM =====
const grid=document.getElementById('grid');
const toggleList=document.getElementById('toggleList');
const search=document.getElementById('search');
const drawArea=document.getElementById('drawArea');
const btn1=document.getElementById('btn1');
const btn3=document.getElementById('btn3');
const toggleQ=document.getElementById('toggleQ');
const inputQ=document.getElementById('inputQ');
const qBox=document.getElementById('qBox');

// ===== ëª©ë¡ ë Œë” =====
function renderList(list){
  grid.innerHTML='';
  list.forEach(c=>{
    const el=document.createElement('article');
    el.className='card';
    el.innerHTML = `
      <div class="row"><span class="chip">${c.num}</span><span class="chip">${c.code}</span><span class="chip">${c.kr}</span></div>
      <div class="img-box"><img src="images/ë ˆë…¸ë¨¼ë“œ-${c.num}.png" alt="${c.num}. ${c.code}"/></div>
      <p><strong>${c.num}. ${c.code}</strong> (${c.kr})</p>
      <p><em>${c.key}</em> â€” ${c.add}</p>
    `;
    grid.appendChild(el);
  });
}
renderList(CARDS);

// ===== ëª©ë¡ í† ê¸€ =====
let open=false;
function setOpen(v){
  open=!!v; grid.style.display=open?'grid':'none';
  toggleList.textContent=open?'ğŸ“ ì¹´ë“œ ì ‘ê¸°':'ğŸ“‚ ì¹´ë“œ ì „ì²´ ë³´ê¸°';
}
setOpen(false);
toggleList.addEventListener('click',()=>setOpen(!open));

// ===== ê²€ìƒ‰ =====
search.addEventListener('input', e=>{
  const v=e.target.value.trim().toLowerCase();
  const f=CARDS.filter(c=>`${c.num}`.includes(v)||c.code.toLowerCase().includes(v)||c.kr.includes(v));
  renderList(f);
});

// ===== ë½‘ê¸° =====
function pick(n){
  const arr=[]; for(let i=0;i<n;i++) arr.push(CARDS[Math.floor(Math.random()*CARDS.length)]);

  if(toggleQ.checked && inputQ.value.trim()){
    qBox.textContent="ì§ˆë¬¸: "+inputQ.value.trim();
  } else qBox.textContent="";

  drawArea.classList.remove("triple","five");
  const sum=document.getElementById("drawSummary");
  sum.classList.add("hidden"); sum.innerHTML="";

  if(n===3) drawArea.classList.add("triple");
  if(n===5) drawArea.classList.add("five");

  drawArea.innerHTML="";
  arr.forEach(c=>{
    const el=document.createElement("div");
    el.className="card-mini "+typeClass(c.type);
    el.innerHTML=`
      <span class="type-badge">${typeEmoji(c.type)}</span>
      <div class="img-box"><img src="${imgPath(c.num)}"></div>
      <p><strong>${c.num}. ${c.code}</strong> (${c.kr})</p>
      <p><em>${c.key}</em> â€” ${c.add}</p>
    `;
    drawArea.appendChild(el);
  });

  if(n===5){
    // ìƒì„¸ ìë™ í•´ì„ìœ¼ë¡œ ëŒ€ì²´
    const html = buildFiveSummary(arr, (toggleQ.checked?inputQ.value:'') );
    sum.innerHTML = html;
    sum.classList.remove("hidden");
  }
}
  if(toggleQ.checked && inputQ.value.trim()){ qBox.textContent='ì§ˆë¬¸: '+inputQ.value.trim(); } else { qBox.textContent=''; }

  drawArea.classList.remove('triple','five');
  const summaryEl=document.getElementById('drawSummary');
  summaryEl.classList.add('hidden');
  summaryEl.innerHTML='';

  if(n===3) drawArea.classList.add('triple');
  if(n===5) drawArea.classList.add('five');

  drawArea.innerHTML='';
  const typeClass=t=> t==='positive'?'card-positive':(t==='negative'?'card-negative':'card-neutral');
  const typeEmoji=t=> t==='positive'?'ğŸ”µ':(t==='negative'?'ğŸ”´':'ğŸŸ¢');

  arr.forEach(c=>{
    const el=document.createElement('article');
    el.className='card-mini';
    if(n===5){ el.classList.add(typeClass(c.type)); }
    el.innerHTML=`
      ${n===5?`<span class="type-badge">${typeEmoji(c.type)}</span>`:''}
      <div class="img-box"><img src="images/ë ˆë…¸ë¨¼ë“œ-${c.num}.png" alt="${c.num}. ${c.code}"></div>
      <p><strong>${c.num}. ${c.code}</strong> (${c.kr})</p>
      <p><em>${c.key}</em> â€” ${c.add}</p>
    `;
    drawArea.appendChild(el);
  });

  if(n===5){
    const pos=arr.filter(c=>c.type==='positive').length;
    const neg=arr.filter(c=>c.type==='negative').length;
    const neu=arr.filter(c=>c.type==='neutral').length;
    const verdict = pos>neg ? 'ì „ë°˜ì ìœ¼ë¡œ **ìš°í˜¸ì ** íë¦„' : (neg>pos ? 'ì „ë°˜ì ìœ¼ë¡œ **ì‹ ì¤‘/ë³´ìˆ˜ì ** íë¦„' : '**ê· í˜•/ì¤‘ë¦½** íë¦„');
    summaryEl.innerHTML=`ğŸ” ì´í‰ â€” ğŸ”µ ${pos} Â· ğŸ”´ ${neg} Â· ğŸŸ¢ ${neu}<br>${verdict}ìœ¼ë¡œ ë³´ì…ë‹ˆë‹¤.`;
    summaryEl.classList.remove('hidden');
  }
}
  drawArea.classList.toggle('triple', n===3);
  drawArea.innerHTML='';
  if(toggleQ.checked && inputQ.value.trim()){
    qBox.textContent = 'ì§ˆë¬¸: '+inputQ.value.trim();
  } else { qBox.textContent=''; }
  arr.forEach(c=>{
    const el=document.createElement('article');
    el.className='card-mini';
    el.innerHTML=`
      <div class="img-box"><img src="images/ë ˆë…¸ë¨¼ë“œ-${c.num}.png" alt="${c.num}. ${c.code}"></div>
      <p><strong>${c.num}. ${c.code}</strong> (${c.kr})</p>
      <p><em>${c.key}</em> â€” ${c.add}</p>
    `;
    drawArea.appendChild(el);
  });
}
btn1.addEventListener('click',()=>pick(1));
btn3.addEventListener('click',()=>pick(3));

// ===== ì§ˆë¬¸ ì…ë ¥ í‘œì‹œ =====
toggleQ.addEventListener('change',()=>{
  if(toggleQ.checked){ inputQ.style.display='block'; inputQ.focus(); }
  else { inputQ.style.display='none'; inputQ.value=''; qBox.textContent=''; }
});


/* ======== Grand Tableau JS ======== */
const btnGT94=document.getElementById('btnGT94');
const btnGT84=document.getElementById('btnGT84');
const gtArea=document.getElementById('gtArea');
const showHouses=document.getElementById('showHouses');

const byNum = new Map(CARDS.map(c=>[c.num,c]));
function shuffle(arr){ for(let i=arr.length-1;i>0;i--){ const j=Math.floor(Math.random()*(i+1)); [arr[i],arr[j]]=[arr[j],arr[i]];} return arr; }
function dealOrder(){ return shuffle(Array.from({length:36},(_,i)=>i+1)); }
function cellHTML(num, houseNo){
  const c = byNum.get(num);
  return `
    <div class="gt-cell">
      ${showHouses && showHouses.checked ? `<span class="housechip">H${houseNo}</span>` : ''}
      <div class="img-box"><img src="images/ë ˆë…¸ë¨¼ë“œ-${c.num}.png" alt="${c.num}. ${c.code}"></div>
      <div class="gt-meta"><strong>${c.num}. ${c.code}</strong> (${c.kr}) â€” <em>${c.key}</em></div>
    </div>`;
}

function renderGT94(){
  const order=dealOrder();
  const cells = order.map((num,idx)=>cellHTML(num, idx+1)).join('');
  gtArea.innerHTML = `<div class="gt-grid cols-9">${cells}</div>`;
}

function renderGT84(){
  const order=dealOrder();
  const top32 = order.slice(0,32).map((num,idx)=>cellHTML(num, idx+1)).join('');
  const last4 = order.slice(32).map((num,idx)=>cellHTML(num, 33+idx)).join('');
  gtArea.innerHTML = `<div class="gt-grid cols-8">${top32}</div><div class="gt-bottom4">${last4}</div>`;
}

if(btnGT94) btnGT94.addEventListener('click', renderGT94);
if(btnGT84) btnGT84.addEventListener('click', renderGT84);
if(showHouses) showHouses.addEventListener('change', ()=>{ /* ì¦‰ì‹œ ì¬ë Œë” */ if(gtArea.firstChild){ gtArea.firstChild.click?.(); } });


// 1/3/5 ë²„íŠ¼ í• ë‹¹ ë³´ê°• (ì¤‘ë³µ ë°©ì§€ìš© ë®ì–´ì“°ê¸°)
if(btn1) btn1.onclick = ()=>pick(1);
if(btn3) btn3.onclick = ()=>pick(3);
const btn5=document.getElementById('btn5');
if(btn5) btn5.onclick = ()=>pick(5);

/* === PATCH: ì„±í–¥ ë°°ì§€ ì „ì—­ ì ìš© (ì¹´ë“œ ëª©ë¡ / 1ì¹´ë“œ / 3ì¹´ë“œ / 5ì¹´ë“œ) === */
window.typeClass = window.typeClass || (t => t==='positive' ? 'card-positive' : (t==='negative' ? 'card-negative' : 'card-neutral'));
window.typeEmoji = window.typeEmoji || (t => t==='positive' ? 'ğŸ”µ' : (t==='negative' ? 'ğŸ”´' : 'ğŸŸ¢'));

// ëª©ë¡ ë Œë” ì˜¤ë²„ë¼ì´ë“œ
if (typeof loadList === 'function') {
  loadList = function(list){
    const grid = document.getElementById('grid');
    if(!grid) return;
    grid.innerHTML = '';
    list.forEach(c => {
      const div = document.createElement('div');
      div.className = 'card ' + typeClass(c.type);
      div.innerHTML = `
        <span class="type-badge">${typeEmoji(c.type)}</span>
        <div class="img-box"><img src="${imgPath(c.num)}" alt="${c.num}. ${c.code}"></div>
        <p><strong>${c.num}. ${c.code}</strong> (${c.kr})</p>
        <p>${c.key}</p>
      `;
      grid.appendChild(div);
    });
  }
}

// ë½‘ê¸° ì˜¤ë²„ë¼ì´ë“œ
if (typeof pick === 'function') {
  pick = function(n){
    const drawArea = document.getElementById('drawArea');
    const toggleQ = document.getElementById('toggleQ');
    const inputQ = document.getElementById('inputQ');
    const qBox = document.getElementById('qBox');

    const arr = [];
    for(let i=0;i<n;i++){ arr.push(CARDS[Math.floor(Math.random()*CARDS.length)]); }

    if(toggleQ && toggleQ.checked && inputQ && inputQ.value.trim()){
      qBox.textContent = 'ì§ˆë¬¸: ' + inputQ.value.trim();
    } else if(qBox){ qBox.textContent = ''; }

    if(drawArea){
      drawArea.classList.remove('triple','five');
      const summaryEl = document.getElementById('drawSummary');
      if(summaryEl){ summaryEl.classList.add('hidden'); summaryEl.innerHTML=''; }

      if(n===3) drawArea.classList.add('triple');
      if(n===5) drawArea.classList.add('five');

      drawArea.innerHTML = '';
      arr.forEach(c => {
        const el = document.createElement('article');
        el.className = 'card-mini ' + typeClass(c.type);
        el.innerHTML = `
          <span class="type-badge">${typeEmoji(c.type)}</span>
          <div class="img-box"><img src="${imgPath(c.num)}" alt="${c.num}. ${c.code}"></div>
          <p><strong>${c.num}. ${c.code}</strong> (${c.kr})</p>
          <p><em>${c.key}</em> â€” ${c.add}</p>
        `;
        drawArea.appendChild(el);
      });

      if(n===5 && summaryEl){
        const pos = arr.filter(c=>c.type==='positive').length;
        const neg = arr.filter(c=>c.type==='negative').length;
        const neu = arr.filter(c=>c.type==='neutral').length;
        const mood = pos>neg ? 'ì „ë°˜ì ìœ¼ë¡œ **ìš°í˜¸ì  íë¦„**' : (neg>pos ? 'ì „ë°˜ì ìœ¼ë¡œ **ì‹ ì¤‘/ë³´ìˆ˜ì  íë¦„**' : '**ê· í˜•/ì¤‘ë¦½ íë¦„**');
        summaryEl.innerHTML = `ğŸ” ì´í‰ â€” ğŸ”µ ${pos} Â· ğŸ”´ ${neg} Â· ğŸŸ¢ ${neu}<br>${mood}ìœ¼ë¡œ ë³´ì…ë‹ˆë‹¤.`;
        summaryEl.classList.remove('hidden');
      }
    }
  }
}

/* === 5ì¹´ë“œ ìƒì„¸ ìë™ í•´ì„ ìƒì„±ê¸° === */
function buildFiveSummary(cards, questionText=''){
  const pos=cards.filter(c=>c.type==='positive').length;
  const neg=cards.filter(c=>c.type==='negative').length;
  const neu=cards.filter(c=>c.type==='neutral').length;

  // 1) ì „ë°˜ í†¤ ë¬¸ì¥
  let tone='';
  if(pos>neg)      tone = `ì „ì²´ í†¤: ğŸ”µ ìš°í˜¸ì  (ê¸ì • ${pos} / ë¶€ì • ${neg} / ì¤‘ë¦½ ${neu})`;
  else if(neg>pos) tone = `ì „ì²´ í†¤: ğŸ”´ ì‹ ì¤‘Â·ë³´ìˆ˜ (ê¸ì • ${pos} / ë¶€ì • ${neg} / ì¤‘ë¦½ ${neu})`;
  else             tone = `ì „ì²´ í†¤: ğŸŸ¢ ê· í˜•Â·ì¤‘ë¦½ (ê¸ì • ${pos} / ë¶€ì • ${neg} / ì¤‘ë¦½ ${neu})`;

  // 2) í‚¤ì¹´ë“œ í•˜ì´ë¼ì´íŠ¸
  const has = name => cards.some(c=>c.code===name);
  const highlights=[];
  if(has('Sun')||has('Key')||has('Bouquet')){
    const keys=[]; if(has('Sun')) keys.push('íƒœì–‘'); if(has('Key')) keys.push('ì—´ì‡ '); if(has('Bouquet')) keys.push('ë¶€ì¼€');
    highlights.push(`ì¶”ì§„ ì‹ í˜¸: ${keys.join('Â·')} â†’ ê²°ê³¼ ê°€ì‹œí™”/í•´ê²°ì˜ ì‹¤ë§ˆë¦¬.`);
  }
  if(has('Mountain')||has('Scythe')||has('Coffin')||has('Snake')||has('Cloud')){
    const ks=[]; if(has('Mountain')) ks.push('ì‚°'); if(has('Scythe')) ks.push('ë‚«'); if(has('Coffin')) ks.push('ê´€'); if(has('Snake')) ks.push('ë±€'); if(has('Cloud')) ks.push('êµ¬ë¦„');
    highlights.push(`ë¦¬ìŠ¤í¬: ${ks.join('Â·')} â†’ ì§€ì—°/ë‹¨ì ˆ/í˜¼ì„  ê°€ëŠ¥ì„±, ì¼ì •Â·ê¸°ëŒ€ì¹˜ ì¡°ì •.`);
  }
  if(has('Ring')||has('Letter')||has('Garden')||has('Tower')){
    const ks=[]; if(has('Ring')) ks.push('ë°˜ì§€'); if(has('Letter')) ks.push('í¸ì§€'); if(has('Garden')) ks.push('ì •ì›'); if(has('Tower')) ks.push('íƒ‘');
    highlights.push(`ê³„ì•½Â·ë¬¸ì„œÂ·ê³µì  ì´ìŠˆ: ${ks.join('Â·')} ì²´í¬.`);
  }
  if(has('Fish')||has('Bear')||has('Anchor')){
    const ks=[]; if(has('Fish')) ks.push('ë¬¼ê³ ê¸°'); if(has('Bear')) ks.push('ê³°'); if(has('Anchor')) ks.push('ë‹»');
    highlights.push(`ìì›/ì¬ì •: ${ks.join('Â·')} â†’ í˜„ê¸ˆíë¦„Â·ì§€ì†ê°€ëŠ¥ì„± ì ê²€.`);
  }

  // 3) ê¶Œê³  ë¬¸ì¥ (í–‰ë™ ì œì•ˆ)
  let advice='';
  if(neg>pos){
    advice = 'ê¶Œê³ : ë¦¬ìŠ¤í¬ ë¨¼ì € ì •ë¦¬(ì •ë³´ ì¬í™•ì¸Â·ì¼ì • ì¬ì¡°ì •) í›„ ì‘ì€ ì„±ê³µë¶€í„° ìŒ“ìœ¼ì„¸ìš”.';
    if(has('Crossroad')) advice += ' ì„ íƒì§€ëŠ” ë‹¨ìˆœí™”í•˜ê³  ê¸°ì¤€ì„ ëª…í™•íˆ.';
    if(has('Fox')) advice += ' ê³„ì•½/ë¬¸êµ¬ëŠ” ì„¸ë¶€ ì¡°í•­ê¹Œì§€ í™•ì¸.';
  } else if(pos>neg){
    advice = 'ê¶Œê³ : ìœ ë¦¬í•œ íë¦„ì…ë‹ˆë‹¤. ì§€ê¸ˆ ë“¤ì–´ì˜¨ ì œì•ˆÂ·ì—°ë½ì„ ë°œíŒìœ¼ë¡œ ì†ë„ë¥¼ ë‚´ì„¸ìš”.';
    if(has('Rider')) advice += ' ë¹ ë¥¸ ì‘ë‹µì´ ìœ ë¦¬.';
    if(has('Stork')) advice += ' êµ¬ì¡°/ìŠµê´€ì„ ê¸ì •ì ìœ¼ë¡œ ì—…ë°ì´íŠ¸.';
  } else {
    advice = 'ê¶Œê³ : ë‹¹ì¥ ê²°ë¡ ë³´ë‹¤ ì •ë³´ ì •ë¦¬Â·ìš°ì„ ìˆœìœ„ ì„¸íŒ…ì´ ë¨¼ì €ì…ë‹ˆë‹¤.';
    if(has('Book')) advice += ' ì¶”ê°€ ìë£Œ/ë°ì´í„°ë¥¼ í™•ë³´í•´ í™•ì‹ ë„ë¥¼ ë†’ì´ì„¸ìš”.';
  }

  // 4) ì§ˆë¬¸ ë¬¸êµ¬ ë°˜ì˜
  let qline = '';
  if(questionText && questionText.trim()){
    qline = `ì§ˆë¬¸ ê¸°ì¤€ í•´ì„: â€œ${questionText.trim()}â€`;
  }

  // 5) ì¶œë ¥ HTML
  const bullets = highlights.length ? ('<ul style="margin:6px 0 0 18px">'+highlights.map(h=>`<li>${h}</li>`).join('')+'</ul>') : '';
  return `
    <div><strong>${tone}</strong></div>
    ${qline?`<div style="margin-top:4px">${qline}</div>`:''}
    ${bullets}
    <div style="margin-top:6px">${advice}</div>
  `;
}
</script>
</body>
</html>
